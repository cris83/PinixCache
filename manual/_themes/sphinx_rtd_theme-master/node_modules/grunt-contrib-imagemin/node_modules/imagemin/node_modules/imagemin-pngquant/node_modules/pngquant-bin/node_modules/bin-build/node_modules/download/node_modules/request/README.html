

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>}) &mdash; PINIX Cache Docs 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../../../../../../../../../../../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PINIX Cache Docs 1.0 documentation" href="../../../../../../../../../../../../../../../../index.html"/> 

  
  <script src="../../../../../../../../../../../../../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../../../../../../../../../../../../../index.html" class="icon icon-home"> PINIX Cache Docs
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../../../../../../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../../../../../Global.html">Global</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../../../../../Origin.html">Origin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../../../../../VHost.html">VHost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../../../../../VHost-Proxy.html">Virtual Host Proxy</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../../../../../../../../../../../../../index.html">PINIX Cache Docs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../../../../../../../../../../../../../index.html">Docs</a> &raquo;</li>
      
    <li>})</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../../../../../../../../../../../../../_sources/_themes/sphinx_rtd_theme-master/node_modules/grunt-contrib-imagemin/node_modules/imagemin/node_modules/imagemin-pngquant/node_modules/pngquant-bin/node_modules/bin-build/node_modules/download/node_modules/request/README.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p># Request - Simplified HTTP client</p>
<p>[![npm package](<a class="reference external" href="https://nodei.co/npm/request.png?downloads=true&amp;downloadRank=true&amp;stars=true)](https://nodei.co/npm/request/">https://nodei.co/npm/request.png?downloads=true&amp;downloadRank=true&amp;stars=true)](https://nodei.co/npm/request/</a>)</p>
<p>[![Build status](<a class="reference external" href="https://img.shields.io/travis/request/request.svg?style=flat-square)](https://travis-ci.org/request/request">https://img.shields.io/travis/request/request.svg?style=flat-square)](https://travis-ci.org/request/request</a>)
[![Coverage](<a class="reference external" href="https://img.shields.io/codecov/c/github/request/request.svg?style=flat-square)](https://codecov.io/github/request/request">https://img.shields.io/codecov/c/github/request/request.svg?style=flat-square)](https://codecov.io/github/request/request</a>?branch=master)
[![Coverage](<a class="reference external" href="https://img.shields.io/coveralls/request/request.svg?style=flat-square)](https://coveralls.io/r/request/request">https://img.shields.io/coveralls/request/request.svg?style=flat-square)](https://coveralls.io/r/request/request</a>)
[![Dependency Status](<a class="reference external" href="https://img.shields.io/david/request/request.svg?style=flat-square)](https://david-dm.org/request/request">https://img.shields.io/david/request/request.svg?style=flat-square)](https://david-dm.org/request/request</a>)
[![Gitter](<a class="reference external" href="https://img.shields.io/badge/gitter-join_chat-blue.svg?style=flat-square)](https://gitter.im/request/request">https://img.shields.io/badge/gitter-join_chat-blue.svg?style=flat-square)](https://gitter.im/request/request</a>?utm_source=badge)</p>
<p>## Super simple to use</p>
<p>Request is designed to be the simplest way possible to make http calls. It supports HTTPS and follows redirects by default.</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>js
var request = require(&#8216;request&#8217;);
request(&#8216;<a class="reference external" href="http://www.google.com">http://www.google.com</a>&#8216;, function (error, response, body) {</p>
<blockquote>
<div><dl class="docutils">
<dt>if (!error &amp;&amp; response.statusCode == 200) {</dt>
<dd>console.log(body) // Show the HTML for the Google homepage.</dd>
</dl>
<p>}</p>
</div></blockquote>
<div class="section" id="id5">
<h1>})<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h1>
<p>## Table of contents</p>
<ul class="simple">
<li>[Streaming](#streaming)</li>
<li>[Forms](#forms)</li>
<li>[HTTP Authentication](#http-authentication)</li>
<li>[Custom HTTP Headers](#custom-http-headers)</li>
<li>[OAuth Signing](#oauth-signing)</li>
<li>[Proxies](#proxies)</li>
<li>[Unix Domain Sockets](#unix-domain-sockets)</li>
<li>[TLS/SSL Protocol](#tlsssl-protocol)</li>
<li>[Support for HAR 1.2](#support-for-har-12)</li>
<li>[<strong>All Available Options</strong>](#requestoptions-callback)</li>
</ul>
<p>Request also offers [convenience methods](#convenience-methods) like
<cite>request.defaults</cite> and <cite>request.post</cite>, and there are
lots of [usage examples](#examples) and several
[debugging techniques](#debugging).</p>
<p>&#8212;</p>
<p>## Streaming</p>
<p>You can stream any response to a file stream.</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">request('http://google.com/doodle.png').pipe(fs.createWriteStream('doodle.png'))</span>
<span class="pre">`</span></code></p>
<p>You can also stream a file to a PUT or POST request. This method will also check the file extension against a mapping of file extensions to content-types (in this case <cite>application/json</cite>) and use the proper <cite>content-type</cite> in the PUT request (if the headers don’t already provide one).</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">fs.createReadStream('file.json').pipe(request.put('http://mysite.com/obj.json'))</span>
<span class="pre">`</span></code></p>
<p>Request can also <cite>pipe</cite> to itself. When doing so, <cite>content-type</cite> and <cite>content-length</cite> are preserved in the PUT headers.</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">request.get('http://google.com/img.png').pipe(request.put('http://mysite.com/img.png'))</span>
<span class="pre">`</span></code></p>
<p>Request emits a &#8220;response&#8221; event when a response is received. The <cite>response</cite> argument will be an instance of [http.IncomingMessage](<a class="reference external" href="http://nodejs.org/api/http.html#http_http_incomingmessage">http://nodejs.org/api/http.html#http_http_incomingmessage</a>).</p>
<p><a href="#id6"><span class="problematic" id="id7">``</span></a><a href="#id8"><span class="problematic" id="id9">`</span></a>js
request</p>
<blockquote>
<div><p>.get(&#8216;<a class="reference external" href="http://google.com/img.png">http://google.com/img.png</a>&#8216;)
.on(&#8216;response&#8217;, function(response) {</p>
<blockquote>
<div>console.log(response.statusCode) // 200
console.log(response.headers[&#8216;content-type&#8217;]) // &#8216;image/png&#8217;</div></blockquote>
<p>})
.pipe(request.put(&#8216;<a class="reference external" href="http://mysite.com/img.png">http://mysite.com/img.png</a>&#8216;))</p>
</div></blockquote>
<p><a href="#id10"><span class="problematic" id="id11">``</span></a><a href="#id12"><span class="problematic" id="id13">`</span></a></p>
<p>To easily handle errors when streaming requests, listen to the <cite>error</cite> event before piping:</p>
<p><a href="#id14"><span class="problematic" id="id15">``</span></a><a href="#id16"><span class="problematic" id="id17">`</span></a>js
request</p>
<blockquote>
<div><p>.get(&#8216;<a class="reference external" href="http://mysite.com/doodle.png">http://mysite.com/doodle.png</a>&#8216;)
.on(&#8216;error&#8217;, function(err) {</p>
<blockquote>
<div>console.log(err)</div></blockquote>
<p>})
.pipe(fs.createWriteStream(&#8216;doodle.png&#8217;))</p>
</div></blockquote>
<p><a href="#id18"><span class="problematic" id="id19">``</span></a><a href="#id20"><span class="problematic" id="id21">`</span></a></p>
<p>Now let’s get fancy.</p>
<p><a href="#id22"><span class="problematic" id="id23">``</span></a><a href="#id24"><span class="problematic" id="id25">`</span></a>js
http.createServer(function (req, resp) {</p>
<blockquote>
<div><dl class="docutils">
<dt>if (req.url === &#8216;/doodle.png&#8217;) {</dt>
<dd><dl class="first docutils">
<dt>if (req.method === &#8216;PUT&#8217;) {</dt>
<dd>req.pipe(request.put(&#8216;<a class="reference external" href="http://mysite.com/doodle.png">http://mysite.com/doodle.png</a>&#8216;))</dd>
<dt>} else if (req.method === &#8216;GET&#8217; || req.method === &#8216;HEAD&#8217;) {</dt>
<dd>request.get(&#8216;<a class="reference external" href="http://mysite.com/doodle.png').pipe(resp">http://mysite.com/doodle.png&#8217;).pipe(resp</a>)</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
</div>
<div class="section" id="id26">
<h1>})<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h1>
<p>You can also <cite>pipe()</cite> from <cite>http.ServerRequest</cite> instances, as well as to <cite>http.ServerResponse</cite> instances. The HTTP method, headers, and entity-body data will be sent. Which means that, if you don&#8217;t really care about security, you can do:</p>
<p><a href="#id27"><span class="problematic" id="id28">``</span></a><a href="#id29"><span class="problematic" id="id30">`</span></a>js
http.createServer(function (req, resp) {</p>
<blockquote>
<div><dl class="docutils">
<dt>if (req.url === &#8216;/doodle.png&#8217;) {</dt>
<dd>var x = request(&#8216;<a class="reference external" href="http://mysite.com/doodle.png">http://mysite.com/doodle.png</a>&#8216;)
req.pipe(x)
x.pipe(resp)</dd>
</dl>
<p>}</p>
</div></blockquote>
</div>
<div class="section" id="id31">
<h1>})<a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h1>
<p>And since <cite>pipe()</cite> returns the destination stream in ≥ Node 0.5.x you can do one line proxying. :)</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">req.pipe(request('http://mysite.com/doodle.png')).pipe(resp)</span>
<span class="pre">`</span></code></p>
<p>Also, none of this new functionality conflicts with requests previous features, it just expands them.</p>
<p><a href="#id32"><span class="problematic" id="id33">``</span></a><a href="#id34"><span class="problematic" id="id35">`</span></a>js
var r = request.defaults({&#8216;proxy&#8217;:&#8217;<a class="reference external" href="http://localproxy.com">http://localproxy.com</a>&#8216;})</p>
<dl class="docutils">
<dt>http.createServer(function (req, resp) {</dt>
<dd><dl class="first docutils">
<dt>if (req.url === &#8216;/doodle.png&#8217;) {</dt>
<dd>r.get(&#8216;<a class="reference external" href="http://google.com/doodle.png').pipe(resp">http://google.com/doodle.png&#8217;).pipe(resp</a>)</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
</div>
<div class="section" id="id36">
<h1>})<a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h1>
<p>You can still use intermediate proxies, the requests will still follow HTTP forwards, etc.</p>
<p>[back to top](#table-of-contents)</p>
<p>&#8212;</p>
<p>## Forms</p>
<p><cite>request</cite> supports <cite>application/x-www-form-urlencoded</cite> and <cite>multipart/form-data</cite> form uploads. For <cite>multipart/related</cite> refer to the <cite>multipart</cite> API.</p>
<p>#### application/x-www-form-urlencoded (URL-Encoded Forms)</p>
<p>URL-encoded forms are simple.</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">request.post('http://service.com/upload',</span> <span class="pre">{form:{key:'value'}})</span>
<span class="pre">//</span> <span class="pre">or</span>
<span class="pre">request.post('http://service.com/upload').form({key:'value'})</span>
<span class="pre">//</span> <span class="pre">or</span>
<span class="pre">request.post({url:'http://service.com/upload',</span> <span class="pre">form:</span> <span class="pre">{key:'value'}},</span> <span class="pre">function(err,httpResponse,body){</span> <span class="pre">/*</span> <span class="pre">...</span> <span class="pre">*/</span> <span class="pre">})</span>
<span class="pre">`</span></code></p>
<p>#### multipart/form-data (Multipart Form Uploads)</p>
<p>For <cite>multipart/form-data</cite> we use the [form-data](<a class="reference external" href="https://github.com/felixge/node-form-data">https://github.com/felixge/node-form-data</a>) library by [&#64;felixge](<a class="reference external" href="https://github.com/felixge">https://github.com/felixge</a>). For the most cases, you can pass your upload form data via the <cite>formData</cite> option.</p>
<p><a href="#id37"><span class="problematic" id="id38">``</span></a><a href="#id39"><span class="problematic" id="id40">`</span></a>js
var formData = {</p>
<blockquote>
<div><p>// Pass a simple key-value pair
my_field: &#8216;my_value&#8217;,
// Pass data via Buffers
my_buffer: new Buffer([1, 2, 3]),
// Pass data via Streams
my_file: fs.createReadStream(__dirname + &#8216;/unicycle.jpg&#8217;),
// Pass multiple values /w an Array
attachments: [</p>
<blockquote>
<div>fs.createReadStream(__dirname + &#8216;/attachment1.jpg&#8217;),
fs.createReadStream(__dirname + &#8216;/attachment2.jpg&#8217;)</div></blockquote>
<p>],
// Pass optional meta-data with an &#8216;options&#8217; object with style: {value: DATA, options: OPTIONS}
// Use case: for some types of streams, you&#8217;ll need to provide &#8220;file&#8221;-related information manually.
// See the <cite>form-data</cite> README for more information about options: <a class="reference external" href="https://github.com/felixge/node-form-data">https://github.com/felixge/node-form-data</a>
custom_file: {</p>
<blockquote>
<div><p>value:  fs.createReadStream(&#8216;/dev/urandom&#8217;),
options: {</p>
<blockquote>
<div>filename: &#8216;topsecret.jpg&#8217;,
contentType: &#8216;image/jpg&#8217;</div></blockquote>
<p>}</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>};
request.post({url:&#8217;http://service.com/upload&#8217;, formData: formData}, function optionalCallback(err, httpResponse, body) {</p>
<blockquote>
<div><dl class="docutils">
<dt>if (err) {</dt>
<dd>return console.error(&#8216;upload failed:&#8217;, err);</dd>
</dl>
<p>}
console.log(&#8216;Upload successful!  Server responded with:&#8217;, body);</p>
</div></blockquote>
</div>
<div class="section" id="id41">
<h1>});<a class="headerlink" href="#id41" title="Permalink to this headline">¶</a></h1>
<p>For advanced cases, you can access the form-data object itself via <cite>r.form()</cite>. This can be modified until the request is fired on the next cycle of the event-loop. (Note that this calling <cite>form()</cite> will clear the currently set form data for that request.)</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">//</span> <span class="pre">NOTE:</span> <span class="pre">Advanced</span> <span class="pre">use-case,</span> <span class="pre">for</span> <span class="pre">normal</span> <span class="pre">use</span> <span class="pre">see</span> <span class="pre">'formData'</span> <span class="pre">usage</span> <span class="pre">above</span>
<span class="pre">var</span> <span class="pre">r</span> <span class="pre">=</span> <span class="pre">request.post('http://service.com/upload',</span> <span class="pre">function</span> <span class="pre">optionalCallback(err,</span> <span class="pre">httpResponse,</span> <span class="pre">body)</span> <span class="pre">{...})</span>
<span class="pre">var</span> <span class="pre">form</span> <span class="pre">=</span> <span class="pre">r.form();</span>
<span class="pre">form.append('my_field',</span> <span class="pre">'my_value');</span>
<span class="pre">form.append('my_buffer',</span> <span class="pre">new</span> <span class="pre">Buffer([1,</span> <span class="pre">2,</span> <span class="pre">3]));</span>
<span class="pre">form.append('custom_file',</span> <span class="pre">fs.createReadStream(__dirname</span> <span class="pre">+</span> <span class="pre">'/unicycle.jpg'),</span> <span class="pre">{filename:</span> <span class="pre">'unicycle.jpg'});</span>
<span class="pre">`</span></code>
See the [form-data README](<a class="reference external" href="https://github.com/felixge/node-form-data">https://github.com/felixge/node-form-data</a>) for more information &amp; examples.</p>
<p>#### multipart/related</p>
<p>Some variations in different HTTP implementations require a newline/CRLF before, after, or both before and after the boundary of a <cite>multipart/related</cite> request (using the multipart option). This has been observed in the .NET WebAPI version 4.0. You can turn on a boundary preambleCRLF or postamble by passing them as <cite>true</cite> to your request options.</p>
<dl class="docutils">
<dt><a href="#id42"><span class="problematic" id="id43">``</span></a><a href="#id44"><span class="problematic" id="id45">`</span></a>js</dt>
<dd><dl class="first docutils">
<dt>request({</dt>
<dd><p class="first">method: &#8216;PUT&#8217;,
preambleCRLF: true,
postambleCRLF: true,
uri: &#8216;<a class="reference external" href="http://service.com/upload">http://service.com/upload</a>&#8216;,
multipart: [</p>
<blockquote>
<div><dl class="docutils">
<dt>{</dt>
<dd>&#8216;content-type&#8217;: &#8216;application/json&#8217;
body: JSON.stringify({foo: &#8216;bar&#8217;, _attachments: {&#8216;message.txt&#8217;: {follows: true, length: 18, &#8216;content_type&#8217;: &#8216;text/plain&#8217; }}})</dd>
</dl>
<p>},
{ body: &#8216;I am an attachment&#8217; },
{ body: fs.createReadStream(&#8216;image.png&#8217;) }</p>
</div></blockquote>
<p>],
// alternatively pass an object containing additional options
multipart: {</p>
<blockquote>
<div><p>chunked: false,
data: [</p>
<blockquote>
<div><dl class="docutils">
<dt>{</dt>
<dd>&#8216;content-type&#8217;: &#8216;application/json&#8217;,
body: JSON.stringify({foo: &#8216;bar&#8217;, _attachments: {&#8216;message.txt&#8217;: {follows: true, length: 18, &#8216;content_type&#8217;: &#8216;text/plain&#8217; }}})</dd>
</dl>
<p>},
{ body: &#8216;I am an attachment&#8217; }</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p class="last">}</p>
</dd>
</dl>
<p>},
function (error, response, body) {</p>
<blockquote>
<div><dl class="docutils">
<dt>if (error) {</dt>
<dd>return console.error(&#8216;upload failed:&#8217;, error);</dd>
</dl>
<p>}
console.log(&#8216;Upload successful!  Server responded with:&#8217;, body);</p>
</div></blockquote>
<p class="last">})</p>
</dd>
</dl>
<p><a href="#id46"><span class="problematic" id="id47">``</span></a><a href="#id48"><span class="problematic" id="id49">`</span></a></p>
<p>[back to top](#table-of-contents)</p>
<p>&#8212;</p>
<p>## HTTP Authentication</p>
<p><a href="#id50"><span class="problematic" id="id51">``</span></a><a href="#id52"><span class="problematic" id="id53">`</span></a>js
request.get(&#8216;<a class="reference external" href="http://some.server.com/').auth('username">http://some.server.com/&#8217;).auth(&#8216;username</a>&#8216;, &#8216;password&#8217;, false);
// or
request.get(&#8216;<a class="reference external" href="http://some.server.com/">http://some.server.com/</a>&#8216;, {</p>
<blockquote>
<div><dl class="docutils">
<dt>&#8216;auth&#8217;: {</dt>
<dd>&#8216;user&#8217;: &#8216;username&#8217;,
&#8216;pass&#8217;: &#8216;password&#8217;,
&#8216;sendImmediately&#8217;: false</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>});
// or
request.get(&#8216;<a class="reference external" href="http://some.server.com/').auth(null">http://some.server.com/&#8217;).auth(null</a>, null, true, &#8216;bearerToken&#8217;);
// or
request.get(&#8216;<a class="reference external" href="http://some.server.com/">http://some.server.com/</a>&#8216;, {</p>
<blockquote>
<div><dl class="docutils">
<dt>&#8216;auth&#8217;: {</dt>
<dd>&#8216;bearer&#8217;: &#8216;bearerToken&#8217;</dd>
</dl>
<p>}</p>
</div></blockquote>
</div>
<div class="section" id="id54">
<h1>});<a class="headerlink" href="#id54" title="Permalink to this headline">¶</a></h1>
<p>If passed as an option, <cite>auth</cite> should be a hash containing values:</p>
<ul class="simple">
<li><cite>user</cite> || <cite>username</cite></li>
<li><cite>pass</cite> || <cite>password</cite></li>
<li><cite>sendImmediately</cite> (optional)</li>
<li><cite>bearer</cite> (optional)</li>
</ul>
<p>The method form takes parameters
<cite>auth(username, password, sendImmediately, bearer)</cite>.</p>
<p><cite>sendImmediately</cite> defaults to <cite>true</cite>, which causes a basic or bearer
authentication header to be sent.  If <cite>sendImmediately</cite> is <cite>false</cite>, then
<cite>request</cite> will retry with a proper authentication header after receiving a
<cite>401</cite> response from the server (which must contain a <cite>WWW-Authenticate</cite> header
indicating the required authentication method).</p>
<p>Note that you can also specify basic authentication using the URL itself, as
detailed in [RFC 1738](<a class="reference external" href="http://www.ietf.org/rfc/rfc1738.txt">http://www.ietf.org/rfc/rfc1738.txt</a>).  Simply pass the
<cite>user:password</cite> before the host with an <cite>&#64;</cite> sign:</p>
<p><a href="#id55"><span class="problematic" id="id56">``</span></a><a href="#id57"><span class="problematic" id="id58">`</span></a>js
var username = &#8216;username&#8217;,</p>
<blockquote>
<div>password = &#8216;password&#8217;,
url = &#8216;<a class="reference external" href="http://">http://</a>&#8216; + username + &#8216;:&#8217; + password + <a class="reference external" href="mailto:'&#37;&#52;&#48;some&#46;server&#46;com">'<span>&#64;</span>some<span>&#46;</span>server<span>&#46;</span>com</a>&#8216;;</div></blockquote>
<dl class="docutils">
<dt>request({url: url}, function (error, response, body) {</dt>
<dd>// Do more stuff with &#8216;body&#8217; here</dd>
</dl>
</div>
<div class="section" id="id59">
<h1>});<a class="headerlink" href="#id59" title="Permalink to this headline">¶</a></h1>
<p>Digest authentication is supported, but it only works with <cite>sendImmediately</cite>
set to <cite>false</cite>; otherwise <cite>request</cite> will send basic authentication on the
initial request, which will probably cause the request to fail.</p>
<p>Bearer authentication is supported, and is activated when the <cite>bearer</cite> value is
available. The value may be either a <cite>String</cite> or a <cite>Function</cite> returning a
<cite>String</cite>. Using a function to supply the bearer token is particularly useful if
used in conjuction with <cite>defaults</cite> to allow a single function to supply the
last known token at the time of sending a request, or to compute one on the fly.</p>
<p>[back to top](#table-of-contents)</p>
<p>&#8212;</p>
<p>## Custom HTTP Headers</p>
<p>HTTP Headers, such as <cite>User-Agent</cite>, can be set in the <cite>options</cite> object.
In the example below, we call the github API to find out the number
of stars and forks for the request repository. This requires a
custom <cite>User-Agent</cite> header as well as https.</p>
<p><a href="#id60"><span class="problematic" id="id61">``</span></a><a href="#id62"><span class="problematic" id="id63">`</span></a>js
var request = require(&#8216;request&#8217;);</p>
<dl class="docutils">
<dt>var options = {</dt>
<dd><p class="first">url: &#8216;<a class="reference external" href="https://api.github.com/repos/request/request">https://api.github.com/repos/request/request</a>&#8216;,
headers: {</p>
<blockquote>
<div>&#8216;User-Agent&#8217;: &#8216;request&#8217;</div></blockquote>
<p class="last">}</p>
</dd>
</dl>
<p>};</p>
<dl class="docutils">
<dt>function callback(error, response, body) {</dt>
<dd><dl class="first docutils">
<dt>if (!error &amp;&amp; response.statusCode == 200) {</dt>
<dd>var info = JSON.parse(body);
console.log(info.stargazers_count + &#8221; Stars&#8221;);
console.log(info.forks_count + &#8221; Forks&#8221;);</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<p>}</p>
<p>request(options, callback);
<a href="#id64"><span class="problematic" id="id65">``</span></a><a href="#id66"><span class="problematic" id="id67">`</span></a></p>
<p>[back to top](#table-of-contents)</p>
<p>&#8212;</p>
<p>## OAuth Signing</p>
<p>[OAuth version 1.0](<a class="reference external" href="https://tools.ietf.org/html/rfc5849">https://tools.ietf.org/html/rfc5849</a>) is supported.  The
default signing algorithm is
[HMAC-SHA1](<a class="reference external" href="https://tools.ietf.org/html/rfc5849#section-3.4.2">https://tools.ietf.org/html/rfc5849#section-3.4.2</a>):</p>
<p><a href="#id68"><span class="problematic" id="id69">``</span></a><a href="#id70"><span class="problematic" id="id71">`</span></a>js
// OAuth1.0 - 3-legged server side flow (Twitter example)
// step 1
var qs = require(&#8216;querystring&#8217;)</p>
<blockquote>
<div><dl class="docutils">
<dt>, oauth =</dt>
<dd>{ callback: &#8216;<a class="reference external" href="http://mysite.com/callback/">http://mysite.com/callback/</a>&#8216;
, consumer_key: CONSUMER_KEY
, consumer_secret: CONSUMER_SECRET
}</dd>
</dl>
<p>, url = &#8216;<a class="reference external" href="https://api.twitter.com/oauth/request_token">https://api.twitter.com/oauth/request_token</a>&#8216;
;</p>
</div></blockquote>
<dl class="docutils">
<dt>request.post({url:url, oauth:oauth}, function (e, r, body) {</dt>
<dd><p class="first">// Ideally, you would take the body in the response
// and construct a URL that a user clicks on (like a sign in button).
// The verifier is only available in the response after a user has
// verified with twitter that they are authorizing your app.</p>
<p>// step 2
var req_data = qs.parse(body)
var uri = &#8216;<a class="reference external" href="https://api.twitter.com/oauth/authenticate">https://api.twitter.com/oauth/authenticate</a>&#8216;</p>
<blockquote>
<div><ul class="simple">
<li>&#8216;?&#8217; + qs.stringify({oauth_token: req_data.oauth_token})</li>
</ul>
</div></blockquote>
<p>// redirect the user to the authorize uri</p>
<p>// step 3
// after the user is redirected back to your server
var auth_data = qs.parse(body)</p>
<blockquote>
<div><dl class="docutils">
<dt>, oauth =</dt>
<dd>{ consumer_key: CONSUMER_KEY
, consumer_secret: CONSUMER_SECRET
, token: auth_data.oauth_token
, token_secret: req_data.oauth_token_secret
, verifier: auth_data.oauth_verifier
}</dd>
</dl>
<p>, url = &#8216;<a class="reference external" href="https://api.twitter.com/oauth/access_token">https://api.twitter.com/oauth/access_token</a>&#8216;
;</p>
</div></blockquote>
<dl class="docutils">
<dt>request.post({url:url, oauth:oauth}, function (e, r, body) {</dt>
<dd><p class="first">// ready to make signed requests on behalf of the user
var perm_data = qs.parse(body)</p>
<blockquote>
<div><dl class="docutils">
<dt>, oauth =</dt>
<dd>{ consumer_key: CONSUMER_KEY
, consumer_secret: CONSUMER_SECRET
, token: perm_data.oauth_token
, token_secret: perm_data.oauth_token_secret
}</dd>
</dl>
<p>, url = &#8216;<a class="reference external" href="https://api.twitter.com/1.1/users/show.json">https://api.twitter.com/1.1/users/show.json</a>&#8216;
, qs =</p>
<blockquote>
<div>{ screen_name: perm_data.screen_name
, user_id: perm_data.user_id
}</div></blockquote>
<p>;</p>
</div></blockquote>
<dl class="docutils">
<dt>request.get({url:url, oauth:oauth, qs:qs, json:true}, function (e, r, user) {</dt>
<dd>console.log(user)</dd>
</dl>
<p class="last">})</p>
</dd>
</dl>
<p class="last">})</p>
</dd>
</dl>
</div>
<div class="section" id="id72">
<h1>})<a class="headerlink" href="#id72" title="Permalink to this headline">¶</a></h1>
<p>For [RSA-SHA1 signing](<a class="reference external" href="https://tools.ietf.org/html/rfc5849#section-3.4.3">https://tools.ietf.org/html/rfc5849#section-3.4.3</a>), make
the following changes to the OAuth options object:
* Pass <cite>signature_method : &#8216;RSA-SHA1&#8217;</cite>
* Instead of <cite>consumer_secret</cite>, specify a <cite>private_key</cite> string in</p>
<blockquote>
<div>[PEM format](<a class="reference external" href="http://how2ssl.com/articles/working_with_pem_files/">http://how2ssl.com/articles/working_with_pem_files/</a>)</div></blockquote>
<p>For [PLAINTEXT signing](<a class="reference external" href="http://oauth.net/core/1.0/#anchor22">http://oauth.net/core/1.0/#anchor22</a>), make
the following changes to the OAuth options object:
* Pass <cite>signature_method : &#8216;PLAINTEXT&#8217;</cite></p>
<p>To send OAuth parameters via query params or in a post body as described in The
[Consumer Request Parameters](<a class="reference external" href="http://oauth.net/core/1.0/#consumer_req_param">http://oauth.net/core/1.0/#consumer_req_param</a>)
section of the oauth1 spec:
* Pass <cite>transport_method : &#8216;query&#8217;</cite> or <cite>transport_method : &#8216;body&#8217;</cite> in the OAuth</p>
<blockquote>
<div>options object.</div></blockquote>
<ul class="simple">
<li><cite>transport_method</cite> defaults to <cite>&#8216;header&#8217;</cite></li>
</ul>
<p>To use [Request Body Hash](<a class="reference external" href="https://oauth.googlecode.com/svn/spec/ext/body_hash/1.0/oauth-bodyhash.html">https://oauth.googlecode.com/svn/spec/ext/body_hash/1.0/oauth-bodyhash.html</a>) you can either
* Manually generate the body hash and pass it as a string <cite>body_hash: &#8216;...&#8217;</cite>
* Automatically generate the body hash by passing <cite>body_hash: true</cite></p>
<p>[back to top](#table-of-contents)</p>
<p>&#8212;</p>
<p>## Proxies</p>
<p>If you specify a <cite>proxy</cite> option, then the request (and any subsequent
redirects) will be sent via a connection to the proxy server.</p>
<p>If your endpoint is an <cite>https</cite> url, and you are using a proxy, then
request will send a <cite>CONNECT</cite> request to the proxy server <em>first</em>, and
then use the supplied connection to connect to the endpoint.</p>
<p>That is, first it will make a request like:</p>
<p><code class="docutils literal"><span class="pre">`</span>
<span class="pre">HTTP/1.1</span> <span class="pre">CONNECT</span> <span class="pre">endpoint-server.com:80</span>
<span class="pre">Host:</span> <span class="pre">proxy-server.com</span>
<span class="pre">User-Agent:</span> <span class="pre">whatever</span> <span class="pre">user</span> <span class="pre">agent</span> <span class="pre">you</span> <span class="pre">specify</span>
<span class="pre">`</span></code></p>
<p>and then the proxy server make a TCP connection to <cite>endpoint-server</cite>
on port <cite>80</cite>, and return a response that looks like:</p>
<p><code class="docutils literal"><span class="pre">`</span>
<span class="pre">HTTP/1.1</span> <span class="pre">200</span> <span class="pre">OK</span>
<span class="pre">`</span></code></p>
<p>At this point, the connection is left open, and the client is
communicating directly with the <cite>endpoint-server.com</cite> machine.</p>
<p>See [the wikipedia page on HTTP Tunneling](<a class="reference external" href="http://en.wikipedia.org/wiki/HTTP_tunnel">http://en.wikipedia.org/wiki/HTTP_tunnel</a>)
for more information.</p>
<p>By default, when proxying <cite>http</cite> traffic, request will simply make a
standard proxied <cite>http</cite> request.  This is done by making the <cite>url</cite>
section of the initial line of the request a fully qualified url to
the endpoint.</p>
<p>For example, it will make a single request that looks like:</p>
<p><a href="#id73"><span class="problematic" id="id74">``</span></a>`
HTTP/1.1 GET <a class="reference external" href="http://endpoint-server.com/some-url">http://endpoint-server.com/some-url</a>
Host: proxy-server.com
Other-Headers: all go here</p>
<p>request body or whatever
<a href="#id75"><span class="problematic" id="id76">``</span></a><a href="#id77"><span class="problematic" id="id78">`</span></a></p>
<p>Because a pure &#8220;http over http&#8221; tunnel offers no additional security
or other features, it is generally simpler to go with a
straightforward HTTP proxy in this case.  However, if you would like
to force a tunneling proxy, you may set the <cite>tunnel</cite> option to <cite>true</cite>.</p>
<p>You can also make a standard proxied <cite>http</cite> request by explicitly setting
<cite>tunnel : false</cite>, but <strong>note that this will allow the proxy to see the traffic
to/from the destination server</strong>.</p>
<p>If you are using a tunneling proxy, you may set the
<cite>proxyHeaderWhiteList</cite> to share certain headers with the proxy.</p>
<p>You can also set the <cite>proxyHeaderExclusiveList</cite> to share certain
headers only with the proxy and not with destination host.</p>
<p>By default, this set is:</p>
<p><code class="docutils literal"><span class="pre">`</span>
<span class="pre">accept</span>
<span class="pre">accept-charset</span>
<span class="pre">accept-encoding</span>
<span class="pre">accept-language</span>
<span class="pre">accept-ranges</span>
<span class="pre">cache-control</span>
<span class="pre">content-encoding</span>
<span class="pre">content-language</span>
<span class="pre">content-length</span>
<span class="pre">content-location</span>
<span class="pre">content-md5</span>
<span class="pre">content-range</span>
<span class="pre">content-type</span>
<span class="pre">connection</span>
<span class="pre">date</span>
<span class="pre">expect</span>
<span class="pre">max-forwards</span>
<span class="pre">pragma</span>
<span class="pre">proxy-authorization</span>
<span class="pre">referer</span>
<span class="pre">te</span>
<span class="pre">transfer-encoding</span>
<span class="pre">user-agent</span>
<span class="pre">via</span>
<span class="pre">`</span></code></p>
<p>Note that, when using a tunneling proxy, the <cite>proxy-authorization</cite>
header and any headers from custom <cite>proxyHeaderExclusiveList</cite> are
<em>never</em> sent to the endpoint server, but only to the proxy server.</p>
<p>### Controlling proxy behaviour using environment variables</p>
<p>The following environment variables are respected by <cite>request</cite>:</p>
<blockquote>
<div><ul class="simple">
<li><cite>HTTP_PROXY</cite> / <cite>http_proxy</cite></li>
<li><cite>HTTPS_PROXY</cite> / <cite>https_proxy</cite></li>
<li><cite>NO_PROXY</cite> / <cite>no_proxy</cite></li>
</ul>
</div></blockquote>
<p>When <cite>HTTP_PROXY</cite> / <cite>http_proxy</cite> are set, they will be used to proxy non-SSL requests that do not have an explicit <cite>proxy</cite> configuration option present. Similarly, <cite>HTTPS_PROXY</cite> / <cite>https_proxy</cite> will be respected for SSL requests that do not have an explicit <cite>proxy</cite> configuration option. It is valid to define a proxy in one of the environment variables, but then override it for a specific request, using the <cite>proxy</cite> configuration option. Furthermore, the <cite>proxy</cite> configuration option can be explicitly set to false / null to opt out of proxying altogether for that request.</p>
<p><cite>request</cite> is also aware of the <cite>NO_PROXY</cite>/<cite>no_proxy</cite> environment variables. These variables provide a granular way to opt out of proxying, on a per-host basis. It should contain a comma separated list of hosts to opt out of proxying. It is also possible to opt of proxying when a particular destination port is used. Finally, the variable may be set to <cite>*</cite> to opt out of the implicit proxy configuration of the other environment variables.</p>
<p>Here&#8217;s some examples of valid <cite>no_proxy</cite> values:</p>
<blockquote>
<div><ul class="simple">
<li><cite>google.com</cite> - don&#8217;t proxy HTTP/HTTPS requests to Google.</li>
<li><cite>google.com:443</cite> - don&#8217;t proxy HTTPS requests to Google, but <em>do</em> proxy HTTP requests to Google.</li>
<li><cite>google.com:443, yahoo.com:80</cite> - don&#8217;t proxy HTTPS requests to Google, and don&#8217;t proxy HTTP requests to Yahoo!</li>
<li><cite>*</cite> - ignore <cite>https_proxy</cite>/<cite>http_proxy</cite> environment variables altogether.</li>
</ul>
</div></blockquote>
<p>[back to top](#table-of-contents)</p>
<p>&#8212;</p>
<p>## UNIX Domain Sockets</p>
<p><cite>request</cite> supports making requests to [UNIX Domain Sockets](<a class="reference external" href="http://en.wikipedia.org/wiki/Unix_domain_socket">http://en.wikipedia.org/wiki/Unix_domain_socket</a>). To make one, use the following URL scheme:</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">/*</span> <span class="pre">Pattern</span> <span class="pre">*/</span> <span class="pre">'http://unix:SOCKET:PATH'</span>
<span class="pre">/*</span> <span class="pre">Example</span> <span class="pre">*/</span> <span class="pre">request.get('http://unix:/absolute/path/to/unix.socket:/request/path')</span>
<span class="pre">`</span></code></p>
<p>Note: The <cite>SOCKET</cite> path is assumed to be absolute to the root of the host file system.</p>
<p>[back to top](#table-of-contents)</p>
<p>&#8212;</p>
<p>## TLS/SSL Protocol</p>
<p>TLS/SSL Protocol options, such as <cite>cert</cite>, <cite>key</cite> and <cite>passphrase</cite>, can be
set directly in <cite>options</cite> object, in the <cite>agentOptions</cite> property of the <cite>options</cite> object, or even in <cite>https.globalAgent.options</cite>. Keep in mind that, although <cite>agentOptions</cite> allows for a slightly wider range of configurations, the recommendend way is via <cite>options</cite> object directly, as using <cite>agentOptions</cite> or <cite>https.globalAgent.options</cite> would not be applied in the same way in proxied environments (as data travels through a TLS connection instead of an http/https agent).</p>
<p><a href="#id79"><span class="problematic" id="id80">``</span></a><a href="#id81"><span class="problematic" id="id82">`</span></a>js
var fs = require(&#8216;fs&#8217;)</p>
<blockquote>
<div>, path = require(&#8216;path&#8217;)
, certFile = path.resolve(__dirname, &#8216;ssl/client.crt&#8217;)
, keyFile = path.resolve(__dirname, &#8216;ssl/client.key&#8217;)
, caFile = path.resolve(__dirname, &#8216;ssl/ca.cert.pem&#8217;)
, request = require(&#8216;request&#8217;);</div></blockquote>
<dl class="docutils">
<dt>var options = {</dt>
<dd>url: &#8216;<a class="reference external" href="https://api.some-server.com/">https://api.some-server.com/</a>&#8216;,
cert: fs.readFileSync(certFile),
key: fs.readFileSync(keyFile),
passphrase: &#8216;password&#8217;,
ca: fs.readFileSync(caFile)
}</dd>
</dl>
<p>};</p>
<p>request.get(options);
<a href="#id83"><span class="problematic" id="id84">``</span></a><a href="#id85"><span class="problematic" id="id86">`</span></a></p>
<p>### Using <cite>options.agentOptions</cite></p>
<p>In the example below, we call an API requires client side SSL certificate
(in PEM format) with passphrase protected private key (in PEM format) and disable the SSLv3 protocol:</p>
<p><a href="#id87"><span class="problematic" id="id88">``</span></a><a href="#id89"><span class="problematic" id="id90">`</span></a>js
var fs = require(&#8216;fs&#8217;)</p>
<blockquote>
<div>, path = require(&#8216;path&#8217;)
, certFile = path.resolve(__dirname, &#8216;ssl/client.crt&#8217;)
, keyFile = path.resolve(__dirname, &#8216;ssl/client.key&#8217;)
, request = require(&#8216;request&#8217;);</div></blockquote>
<dl class="docutils">
<dt>var options = {</dt>
<dd><p class="first">url: &#8216;<a class="reference external" href="https://api.some-server.com/">https://api.some-server.com/</a>&#8216;,
agentOptions: {</p>
<blockquote>
<div>cert: fs.readFileSync(certFile),
key: fs.readFileSync(keyFile),
// Or use <cite>pfx</cite> property replacing <cite>cert</cite> and <cite>key</cite> when using private key, certificate and CA certs in PFX or PKCS12 format:
// pfx: fs.readFileSync(pfxFilePath),
passphrase: &#8216;password&#8217;,
securityOptions: &#8216;SSL_OP_NO_SSLv3&#8217;</div></blockquote>
<p class="last">}</p>
</dd>
</dl>
<p>};</p>
<p>request.get(options);
<a href="#id91"><span class="problematic" id="id92">``</span></a><a href="#id93"><span class="problematic" id="id94">`</span></a></p>
<p>It is able to force using SSLv3 only by specifying <cite>secureProtocol</cite>:</p>
<p><a href="#id95"><span class="problematic" id="id96">``</span></a><a href="#id97"><span class="problematic" id="id98">`</span></a>js
request.get({</p>
<blockquote>
<div><p>url: &#8216;<a class="reference external" href="https://api.some-server.com/">https://api.some-server.com/</a>&#8216;,
agentOptions: {</p>
<blockquote>
<div>secureProtocol: &#8216;SSLv3_method&#8217;</div></blockquote>
<p>}</p>
</div></blockquote>
</div>
<div class="section" id="id99">
<h1>});<a class="headerlink" href="#id99" title="Permalink to this headline">¶</a></h1>
<p>It is possible to accept other certificates than those signed by generally allowed Certificate Authorities (CAs).
This can be useful, for example,  when using self-signed certificates.
To require a different root certificate, you can specify the signing CA by adding the contents of the CA&#8217;s certificate file to the <cite>agentOptions</cite>.
The certificate the domain presents must be signed by the root certificate specified:</p>
<p><a href="#id100"><span class="problematic" id="id101">``</span></a><a href="#id102"><span class="problematic" id="id103">`</span></a>js
request.get({</p>
<blockquote>
<div><p>url: &#8216;<a class="reference external" href="https://api.some-server.com/">https://api.some-server.com/</a>&#8216;,
agentOptions: {</p>
<blockquote>
<div>ca: fs.readFileSync(&#8216;ca.cert.pem&#8217;)</div></blockquote>
<p>}</p>
</div></blockquote>
</div>
<div class="section" id="id104">
<h1>});<a class="headerlink" href="#id104" title="Permalink to this headline">¶</a></h1>
<p>[back to top](#table-of-contents)</p>
<p>&#8212;</p>
<p>## Support for HAR 1.2</p>
<p>The <cite>options.har</cite> property will override the values: <cite>url</cite>, <cite>method</cite>, <cite>qs</cite>, <cite>headers</cite>, <cite>form</cite>, <cite>formData</cite>, <cite>body</cite>, <cite>json</cite>, as well as construct multipart data and read files from disk when <cite>request.postData.params[].fileName</cite> is present without a matching <cite>value</cite>.</p>
<p>a validation step will check if the HAR Request format matches the latest spec (v1.2) and will skip parsing if not matching.</p>
<dl class="docutils">
<dt><a href="#id105"><span class="problematic" id="id106">``</span></a><a href="#id107"><span class="problematic" id="id108">`</span></a>js</dt>
<dd><p class="first">var request = require(&#8216;request&#8217;)
request({</p>
<blockquote>
<div><p>// will be ignored
method: &#8216;GET&#8217;,
uri: &#8216;<a class="reference external" href="http://www.google.com">http://www.google.com</a>&#8216;,</p>
<p>// HTTP Archive Request Object
har: {</p>
<blockquote>
<div><p>url: &#8216;<a class="reference external" href="http://www.mockbin.com/har">http://www.mockbin.com/har</a>&#8216;,
method: &#8216;POST&#8217;,
headers: [</p>
<blockquote>
<div><dl class="docutils">
<dt>{</dt>
<dd>name: &#8216;content-type&#8217;,
value: &#8216;application/x-www-form-urlencoded&#8217;</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
postData: {</p>
<blockquote>
<div><p>mimeType: &#8216;application/x-www-form-urlencoded&#8217;,
params: [</p>
<blockquote>
<div><dl class="docutils">
<dt>{</dt>
<dd>name: &#8216;foo&#8217;,
value: &#8216;bar&#8217;</dd>
</dl>
<p>},
{</p>
<blockquote>
<div>name: &#8216;hello&#8217;,
value: &#8216;world&#8217;</div></blockquote>
<p>}</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>})</p>
<p class="last">// a POST request will be sent to <a class="reference external" href="http://www.mockbin.com">http://www.mockbin.com</a>
// with body an application/x-www-form-urlencoded body:
// foo=bar&amp;hello=world</p>
</dd>
</dl>
<p><a href="#id109"><span class="problematic" id="id110">``</span></a><a href="#id111"><span class="problematic" id="id112">`</span></a></p>
<p>[back to top](#table-of-contents)</p>
<p>&#8212;</p>
<p>## request(options, callback)</p>
<p>The first argument can be either a <cite>url</cite> or an <cite>options</cite> object. The only required option is <cite>uri</cite>; all others are optional.</p>
<ul class="simple">
<li><cite>uri</cite> || <cite>url</cite> - fully qualified uri or a parsed url object from <cite>url.parse()</cite></li>
<li><cite>baseUrl</cite> - fully qualified uri string used as the base url. Most useful with <cite>request.defaults</cite>, for example when you want to do many requests to the same domain.  If <cite>baseUrl</cite> is <cite>https://example.com/api/</cite>, then requesting <cite>/end/point?test=true</cite> will fetch <cite>https://example.com/api/end/point?test=true</cite>. When <cite>baseUrl</cite> is given, <cite>uri</cite> must also be a string.</li>
<li><cite>method</cite> - http method (default: <cite>&#8220;GET&#8221;</cite>)</li>
<li><cite>headers</cite> - http headers (default: <cite>{}</cite>)</li>
</ul>
<p>&#8212;</p>
<ul class="simple">
<li><cite>qs</cite> - object containing querystring values to be appended to the <cite>uri</cite></li>
<li><cite>qsParseOptions</cite> - object containing options to pass to the [qs.parse](<a class="reference external" href="https://github.com/hapijs/qs#parsing-objects">https://github.com/hapijs/qs#parsing-objects</a>) method. Alternatively pass options to the [querystring.parse](<a class="reference external" href="https://nodejs.org/docs/v0.12.0/api/querystring.html#querystring_querystring_parse_str_sep_eq_options">https://nodejs.org/docs/v0.12.0/api/querystring.html#querystring_querystring_parse_str_sep_eq_options</a>) method using this format <cite>{sep:&#8217;;&#8217;, eq:&#8217;:&#8217;, options:{}}</cite></li>
<li><cite>qsStringifyOptions</cite> - object containing options to pass to the [qs.stringify](<a class="reference external" href="https://github.com/hapijs/qs#stringifying">https://github.com/hapijs/qs#stringifying</a>) method. Alternatively pass options to the  [querystring.stringify](<a class="reference external" href="https://nodejs.org/docs/v0.12.0/api/querystring.html#querystring_querystring_stringify_obj_sep_eq_options">https://nodejs.org/docs/v0.12.0/api/querystring.html#querystring_querystring_stringify_obj_sep_eq_options</a>) method using this format <cite>{sep:&#8217;;&#8217;, eq:&#8217;:&#8217;, options:{}}</cite>. For example, to change the way arrays are converted to query strings using the <cite>qs</cite> module pass the <cite>arrayFormat</cite> option with one of <cite>indices|brackets|repeat</cite></li>
<li><cite>useQuerystring</cite> - If true, use <cite>querystring</cite> to stringify and parse
querystrings, otherwise use <cite>qs</cite> (default: <cite>false</cite>).  Set this option to
<cite>true</cite> if you need arrays to be serialized as <cite>foo=bar&amp;foo=baz</cite> instead of the
default <cite>foo[0]=bar&amp;foo[1]=baz</cite>.</li>
</ul>
<p>&#8212;</p>
<ul>
<li><p class="first"><cite>body</cite> - entity body for PATCH, POST and PUT requests. Must be a <cite>Buffer</cite> or <cite>String</cite>, unless <cite>json</cite> is <cite>true</cite>. If <cite>json</cite> is <cite>true</cite>, then <cite>body</cite> must be a JSON-serializable object.</p>
</li>
<li><p class="first"><cite>form</cite> - when passed an object or a querystring, this sets <cite>body</cite> to a querystring representation of value, and adds <cite>Content-type: application/x-www-form-urlencoded</cite> header. When passed no options, a <cite>FormData</cite> instance is returned (and is piped to request). See &#8220;Forms&#8221; section above.</p>
</li>
<li><p class="first"><cite>formData</cite> - Data to pass for a <cite>multipart/form-data</cite> request. See
[Forms](#forms) section above.</p>
</li>
<li><p class="first"><cite>multipart</cite> - array of objects which contain their own headers and <cite>body</cite>
attributes. Sends a <cite>multipart/related</cite> request. See [Forms](#forms) section
above.
- Alternatively you can pass in an object <cite>{chunked: false, data: []}</cite> where</p>
<blockquote>
<div><p><cite>chunked</cite> is used to specify whether the request is sent in
[chunked transfer encoding](<a class="reference external" href="https://en.wikipedia.org/wiki/Chunked_transfer_encoding">https://en.wikipedia.org/wiki/Chunked_transfer_encoding</a>)
In non-chunked requests, data items with body streams are not allowed.</p>
</div></blockquote>
</li>
<li><p class="first"><cite>preambleCRLF</cite> - append a newline/CRLF before the boundary of your <cite>multipart/form-data</cite> request.</p>
</li>
<li><p class="first"><cite>postambleCRLF</cite> - append a newline/CRLF at the end of the boundary of your <cite>multipart/form-data</cite> request.</p>
</li>
<li><p class="first"><cite>json</cite> - sets <cite>body</cite> but to JSON representation of value and adds <cite>Content-type: application/json</cite> header.  Additionally, parses the response body as JSON.</p>
</li>
<li><p class="first"><cite>jsonReviver</cite> - a [reviver function](<a class="reference external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse</a>) that will be passed to <cite>JSON.parse()</cite> when parsing a JSON response body.</p>
</li>
</ul>
<p>&#8212;</p>
<ul class="simple">
<li><cite>auth</cite> - A hash containing values <cite>user</cite> || <cite>username</cite>, <cite>pass</cite> || <cite>password</cite>, and <cite>sendImmediately</cite> (optional).  See documentation above.</li>
<li><cite>oauth</cite> - Options for OAuth HMAC-SHA1 signing. See documentation above.</li>
<li><cite>hawk</cite> - Options for [Hawk signing](<a class="reference external" href="https://github.com/hueniverse/hawk">https://github.com/hueniverse/hawk</a>). The <cite>credentials</cite> key must contain the necessary signing info, [see hawk docs for details](<a class="reference external" href="https://github.com/hueniverse/hawk#usage-example">https://github.com/hueniverse/hawk#usage-example</a>).</li>
<li><cite>aws</cite> - <cite>object</cite> containing AWS signing information. Should have the properties <cite>key</cite>, <cite>secret</cite>. Also requires the property <cite>bucket</cite>, unless you’re specifying your <cite>bucket</cite> as part of the path, or the request doesn’t use a bucket (i.e. GET Services)</li>
<li><cite>httpSignature</cite> - Options for the [HTTP Signature Scheme](<a class="reference external" href="https://github.com/joyent/node-http-signature/blob/master/http_signing.md">https://github.com/joyent/node-http-signature/blob/master/http_signing.md</a>) using [Joyent&#8217;s library](<a class="reference external" href="https://github.com/joyent/node-http-signature">https://github.com/joyent/node-http-signature</a>). The <cite>keyId</cite> and <cite>key</cite> properties must be specified. See the docs for other options.</li>
</ul>
<p>&#8212;</p>
<ul class="simple">
<li><cite>followRedirect</cite> - follow HTTP 3xx responses as redirects (default: <cite>true</cite>). This property can also be implemented as function which gets <cite>response</cite> object as a single argument and should return <cite>true</cite> if redirects should continue or <cite>false</cite> otherwise.</li>
<li><cite>followAllRedirects</cite> - follow non-GET HTTP 3xx responses as redirects (default: <cite>false</cite>)</li>
<li><cite>maxRedirects</cite> - the maximum number of redirects to follow (default: <cite>10</cite>)</li>
<li><cite>removeRefererHeader</cite> - removes the referer header when a redirect happens (default: <cite>false</cite>).</li>
</ul>
<p>&#8212;</p>
<ul class="simple">
<li><cite>encoding</cite> - Encoding to be used on <cite>setEncoding</cite> of response data. If <cite>null</cite>, the <cite>body</cite> is returned as a <cite>Buffer</cite>. Anything else <strong>(including the default value of `undefined`)</strong> will be passed as the [encoding](<a class="reference external" href="http://nodejs.org/api/buffer.html#buffer_buffer">http://nodejs.org/api/buffer.html#buffer_buffer</a>) parameter to <cite>toString()</cite> (meaning this is effectively <cite>utf8</cite> by default). (<strong>Note:</strong> if you expect binary data, you should set <cite>encoding: null</cite>.)</li>
<li><cite>gzip</cite> - If <cite>true</cite>, add an <cite>Accept-Encoding</cite> header to request compressed content encodings from the server (if not already present) and decode supported content encodings in the response.  <strong>Note:</strong> Automatic decoding of the response content is performed on the body data returned through <cite>request</cite> (both through the <cite>request</cite> stream and passed to the callback function) but is not performed on the <cite>response</cite> stream (available from the <cite>response</cite> event) which is the unmodified <cite>http.IncomingMessage</cite> object which may contain compressed data. See example below.</li>
<li><cite>jar</cite> - If <cite>true</cite> and <cite>tough-cookie</cite> is installed, remember cookies for future use (or define your custom cookie jar; see examples section)</li>
</ul>
<p>&#8212;</p>
<ul>
<li><p class="first"><cite>agent</cite> - <cite>http(s).Agent</cite> instance to use</p>
</li>
<li><p class="first"><cite>agentClass</cite> - alternatively specify your agent&#8217;s class name</p>
</li>
<li><p class="first"><cite>agentOptions</cite> - and pass its options. <strong>Note:</strong> for HTTPS see [tls API doc for TLS/SSL options](<a class="reference external" href="http://nodejs.org/api/tls.html#tls_tls_connect_options_callback">http://nodejs.org/api/tls.html#tls_tls_connect_options_callback</a>) and the [documentation above](#using-optionsagentoptions).</p>
</li>
<li><p class="first"><cite>forever</cite> - set to <cite>true</cite> to use the [forever-agent](<a class="reference external" href="https://github.com/request/forever-agent">https://github.com/request/forever-agent</a>) <strong>Note:</strong> Defaults to <cite>http(s).Agent({keepAlive:true})</cite> in node 0.12+</p>
</li>
<li><p class="first"><cite>pool</cite> - An object describing which agents to use for the request. If this option is omitted the request will use the global agent (as long as your options allow for it). Otherwise, request will search the pool for your custom agent. If no custom agent is found, a new agent will be created and added to the pool. <strong>Note:</strong> <cite>pool</cite> is used only when the <cite>agent</cite> option is not specified.
- A <cite>maxSockets</cite> property can also be provided on the <cite>pool</cite> object to set the max number of sockets for all agents created (ex: <cite>pool: {maxSockets: Infinity}</cite>).
- Note that if you are sending multiple requests in a loop and creating</p>
<blockquote>
<div><p>multiple new <cite>pool</cite> objects, <cite>maxSockets</cite> will not work as intended.  To
work around this, either use [<cite>request.defaults</cite>](#requestdefaultsoptions)
with your pool options or create the pool object with the <cite>maxSockets</cite>
property outside of the loop.</p>
</div></blockquote>
</li>
<li><p class="first"><cite>timeout</cite> - Integer containing the number of milliseconds to wait for a</p>
</li>
</ul>
<p>server to send response headers (and start the response body) before aborting
the request. Note that if the underlying TCP connection cannot be established,
the OS-wide TCP connection timeout will overrule the <cite>timeout</cite> option ([the
default in Linux can be anywhere from 20-120 seconds][linux-timeout]).</p>
<p>[linux-timeout]: <a class="reference external" href="http://www.sekuda.com/overriding_the_default_linux_kernel_20_second_tcp_socket_connect_timeout">http://www.sekuda.com/overriding_the_default_linux_kernel_20_second_tcp_socket_connect_timeout</a></p>
<p>&#8212;</p>
<ul>
<li><p class="first"><cite>localAddress</cite> - Local interface to bind for network connections.</p>
</li>
<li><p class="first"><cite>proxy</cite> - An HTTP proxy to be used. Supports proxy Auth with Basic Auth, identical to support for the <cite>url</cite> parameter (by embedding the auth info in the <cite>uri</cite>)</p>
</li>
<li><p class="first"><cite>strictSSL</cite> - If <cite>true</cite>, requires SSL certificates be valid. <strong>Note:</strong> to use your own certificate authority, you need to specify an agent that was created with that CA as an option.</p>
</li>
<li><p class="first"><cite>tunnel</cite> - controls the behavior of
[HTTP <cite>CONNECT</cite> tunneling](<a class="reference external" href="https://en.wikipedia.org/wiki/HTTP_tunnel#HTTP_CONNECT_tunneling">https://en.wikipedia.org/wiki/HTTP_tunnel#HTTP_CONNECT_tunneling</a>)
as follows:</p>
<blockquote>
<div><ul class="simple">
<li><cite>undefined</cite> (default) - <cite>true</cite> if the destination is <cite>https</cite> or a previous
request in the redirect chain used a tunneling proxy, <cite>false</cite> otherwise</li>
<li><cite>true</cite> - always tunnel to the destination by making a <cite>CONNECT</cite> request to
the proxy</li>
<li><cite>false</cite> - request the destination as a <cite>GET</cite> request.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><cite>proxyHeaderWhiteList</cite> - A whitelist of headers to send to a
tunneling proxy.</p>
</li>
<li><p class="first"><cite>proxyHeaderExclusiveList</cite> - A whitelist of headers to send
exclusively to a tunneling proxy and not to destination.</p>
</li>
</ul>
<p>&#8212;</p>
<ul class="simple">
<li><cite>time</cite> - If <cite>true</cite>, the request-response cycle (including all redirects) is timed at millisecond resolution, and the result provided on the response&#8217;s <cite>elapsedTime</cite> property.</li>
<li><cite>har</cite> - A [HAR 1.2 Request Object](<a class="reference external" href="http://www.softwareishard.com/blog/har-12-spec/#request">http://www.softwareishard.com/blog/har-12-spec/#request</a>), will be processed from HAR format into options overwriting matching values <em>(see the [HAR 1.2 section](#support-for-har-1.2) for details)</em></li>
</ul>
<p>The callback argument gets 3 arguments:</p>
<ol class="arabic simple">
<li>An <cite>error</cite> when applicable (usually from [<cite>http.ClientRequest</cite>](<a class="reference external" href="http://nodejs.org/api/http.html#http_class_http_clientrequest">http://nodejs.org/api/http.html#http_class_http_clientrequest</a>) object)</li>
<li>An [<cite>http.IncomingMessage</cite>](<a class="reference external" href="http://nodejs.org/api/http.html#http_http_incomingmessage">http://nodejs.org/api/http.html#http_http_incomingmessage</a>) object</li>
<li>The third is the <cite>response</cite> body (<cite>String</cite> or <cite>Buffer</cite>, or JSON object if the <cite>json</cite> option is supplied)</li>
</ol>
<p>[back to top](#table-of-contents)</p>
<p>&#8212;</p>
<p>## Convenience methods</p>
<p>There are also shorthand methods for different HTTP METHODs and some other conveniences.</p>
<p>### request.defaults(options)</p>
<p>This method <strong>returns a wrapper</strong> around the normal request API that defaults
to whatever options you pass to it.</p>
<p><strong>Note:</strong> <cite>request.defaults()</cite> <strong>does not</strong> modify the global request API;
instead, it <strong>returns a wrapper</strong> that has your default settings applied to it.</p>
<p><strong>Note:</strong> You can call <cite>.defaults()</cite> on the wrapper that is returned from
<cite>request.defaults</cite> to add/override defaults that were previously defaulted.</p>
<p>For example:
<a href="#id113"><span class="problematic" id="id114">``</span></a><a href="#id115"><span class="problematic" id="id116">`</span></a>js
//requests using baseRequest() will set the &#8216;x-token&#8217; header
var baseRequest = request.defaults({</p>
<blockquote>
<div>headers: {x-token: &#8216;my-token&#8217;}</div></blockquote>
<p>})</p>
<p>//requests using specialRequest() will include the &#8216;x-token&#8217; header set in
//baseRequest and will also include the &#8216;special&#8217; header
var specialRequest = baseRequest.defaults({</p>
<blockquote>
<div>headers: {special: &#8216;special value&#8217;}</div></blockquote>
</div>
<div class="section" id="id117">
<h1>})<a class="headerlink" href="#id117" title="Permalink to this headline">¶</a></h1>
<p>### request.put</p>
<p>Same as <cite>request()</cite>, but defaults to <cite>method: &#8220;PUT&#8221;</cite>.</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">request.put(url)</span>
<span class="pre">`</span></code></p>
<p>### request.patch</p>
<p>Same as <cite>request()</cite>, but defaults to <cite>method: &#8220;PATCH&#8221;</cite>.</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">request.patch(url)</span>
<span class="pre">`</span></code></p>
<p>### request.post</p>
<p>Same as <cite>request()</cite>, but defaults to <cite>method: &#8220;POST&#8221;</cite>.</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">request.post(url)</span>
<span class="pre">`</span></code></p>
<p>### request.head</p>
<p>Same as <cite>request()</cite>, but defaults to <cite>method: &#8220;HEAD&#8221;</cite>.</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">request.head(url)</span>
<span class="pre">`</span></code></p>
<p>### request.del</p>
<p>Same as <cite>request()</cite>, but defaults to <cite>method: &#8220;DELETE&#8221;</cite>.</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">request.del(url)</span>
<span class="pre">`</span></code></p>
<p>### request.get</p>
<p>Same as <cite>request()</cite> (for uniformity).</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">request.get(url)</span>
<span class="pre">`</span></code>
### request.cookie</p>
<p>Function that creates a new cookie.</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">request.cookie('key1=value1')</span>
<span class="pre">`</span></code>
### request.jar()</p>
<p>Function that creates a new cookie jar.</p>
<p><code class="docutils literal"><span class="pre">`js</span>
<span class="pre">request.jar()</span>
<span class="pre">`</span></code></p>
<p>[back to top](#table-of-contents)</p>
<p>&#8212;</p>
<p>## Debugging</p>
<p>There are at least three ways to debug the operation of <cite>request</cite>:</p>
<ol class="arabic simple">
<li>Launch the node process like <cite>NODE_DEBUG=request node script.js</cite>
(<cite>lib,request,otherlib</cite> works too).</li>
<li>Set <cite>require(&#8216;request&#8217;).debug = true</cite> at any time (this does the same thing
as #1).</li>
<li>Use the [request-debug module](<a class="reference external" href="https://github.com/nylen/request-debug">https://github.com/nylen/request-debug</a>) to
view request and response headers and bodies.</li>
</ol>
<p>[back to top](#table-of-contents)</p>
<p>&#8212;</p>
<p>## Timeouts</p>
<p>Most requests to external servers should have a timeout attached, in case the
server is not responding in a timely manner. Without a timeout, your code may
have a socket open/consume resources for minutes or more.</p>
<p>There are two main types of timeouts: <strong>connection timeouts</strong> and <strong>read
timeouts</strong>. A connect timeout occurs if the timeout is hit while your client is
attempting to establish a connection to a remote machine (corresponding to the
[connect() call][connect] on the socket). A read timeout occurs any time the
server is too slow to send back a part of the response.</p>
<p>These two situations have widely different implications for what went wrong
with the request, so it&#8217;s useful to be able to distinguish them. You can detect
timeout errors by checking <cite>err.code</cite> for an &#8216;ETIMEDOUT&#8217; value. Further, you
can detect whether the timeout was a connection timeout by checking if the
<cite>err.connect</cite> property is set to <cite>true</cite>.</p>
<p><a href="#id118"><span class="problematic" id="id119">``</span></a><a href="#id120"><span class="problematic" id="id121">`</span></a>js
request.get(&#8216;<a class="reference external" href="http://10.255.255.1">http://10.255.255.1</a>&#8216;, {timeout: 1500}, function(err) {</p>
<blockquote>
<div>console.log(err.code === &#8216;ETIMEDOUT&#8217;);
// Set to <cite>true</cite> if the timeout was a connection timeout, <cite>false</cite> or
// <cite>undefined</cite> otherwise.
console.log(err.connect === true);
process.exit(0);</div></blockquote>
</div>
<div class="section" id="id122">
<h1>});<a class="headerlink" href="#id122" title="Permalink to this headline">¶</a></h1>
<p>[connect]: <a class="reference external" href="http://linux.die.net/man/2/connect">http://linux.die.net/man/2/connect</a></p>
<p>## Examples:</p>
<dl class="docutils">
<dt><a href="#id123"><span class="problematic" id="id124">``</span></a><a href="#id125"><span class="problematic" id="id126">`</span></a>js</dt>
<dd><dl class="first docutils">
<dt>var request = require(&#8216;request&#8217;)</dt>
<dd>, rand = Math.floor(Math.random()*100000000).toString()
;</dd>
<dt>request(</dt>
<dd><p class="first">{ method: &#8216;PUT&#8217;
, uri: &#8216;<a class="reference external" href="http://mikeal.iriscouch.com/testjs/">http://mikeal.iriscouch.com/testjs/</a>&#8216; + rand
, multipart:</p>
<blockquote>
<div><dl class="docutils">
<dt>[ { &#8216;content-type&#8217;: &#8216;application/json&#8217;</dt>
<dd>,  body: JSON.stringify({foo: &#8216;bar&#8217;, _attachments: {&#8216;message.txt&#8217;: {follows: true, length: 18, &#8216;content_type&#8217;: &#8216;text/plain&#8217; }}})
}</dd>
</dl>
<p>, { body: &#8216;I am an attachment&#8217; }
]</p>
</div></blockquote>
<p class="last">}</p>
</dd>
<dt>, function (error, response, body) {</dt>
<dd><blockquote class="first">
<div><dl class="docutils">
<dt>if(response.statusCode == 201){</dt>
<dd>console.log(&#8216;document saved as: <a class="reference external" href="http://mikeal.iriscouch.com/testjs/'+">http://mikeal.iriscouch.com/testjs/&#8217;+</a> rand)</dd>
<dt>} else {</dt>
<dd>console.log(&#8216;error: &#8216;+ response.statusCode)
console.log(body)</dd>
</dl>
<p>}</p>
</div></blockquote>
<p class="last">}</p>
</dd>
</dl>
<p class="last">)</p>
</dd>
</dl>
<p><a href="#id127"><span class="problematic" id="id128">``</span></a><a href="#id129"><span class="problematic" id="id130">`</span></a></p>
<p>For backwards-compatibility, response compression is not supported by default.
To accept gzip-compressed responses, set the <cite>gzip</cite> option to <cite>true</cite>.  Note
that the body data passed through <cite>request</cite> is automatically decompressed
while the response object is unmodified and will contain compressed data if
the server sent a compressed response.</p>
<dl class="docutils">
<dt><a href="#id131"><span class="problematic" id="id132">``</span></a><a href="#id133"><span class="problematic" id="id134">`</span></a>js</dt>
<dd><p class="first">var request = require(&#8216;request&#8217;)
request(</p>
<blockquote>
<div>{ method: &#8216;GET&#8217;
, uri: &#8216;<a class="reference external" href="http://www.google.com">http://www.google.com</a>&#8216;
, gzip: true
}</div></blockquote>
<dl class="docutils">
<dt>, function (error, response, body) {</dt>
<dd><blockquote class="first">
<div>// body is the decompressed response body
console.log(&#8216;server encoded the data as: &#8216; + (response.headers[&#8216;content-encoding&#8217;] || &#8216;identity&#8217;))
console.log(&#8216;the decoded data is: &#8216; + body)</div></blockquote>
<p class="last">}</p>
</dd>
<dt>).on(&#8216;data&#8217;, function(data) {</dt>
<dd>// decompressed data as it is received
console.log(&#8216;decoded chunk: &#8216; + data)</dd>
</dl>
<p>})
.on(&#8216;response&#8217;, function(response) {</p>
<blockquote>
<div><p>// unmodified http.IncomingMessage object
response.on(&#8216;data&#8217;, function(data) {</p>
<blockquote>
<div>// compressed data as it is received
console.log(&#8216;received &#8216; + data.length + &#8216; bytes of compressed data&#8217;)</div></blockquote>
<p>})</p>
</div></blockquote>
<p class="last">})</p>
</dd>
</dl>
<p><a href="#id135"><span class="problematic" id="id136">``</span></a><a href="#id137"><span class="problematic" id="id138">`</span></a></p>
<p>Cookies are disabled by default (else, they would be used in subsequent requests). To enable cookies, set <cite>jar</cite> to <cite>true</cite> (either in <cite>defaults</cite> or <cite>options</cite>) and install <cite>tough-cookie</cite>.</p>
<p><a href="#id139"><span class="problematic" id="id140">``</span></a><a href="#id141"><span class="problematic" id="id142">`</span></a>js
var request = request.defaults({jar: true})
request(&#8216;<a class="reference external" href="http://www.google.com">http://www.google.com</a>&#8216;, function () {</p>
<blockquote>
<div>request(&#8216;<a class="reference external" href="http://images.google.com">http://images.google.com</a>&#8216;)</div></blockquote>
</div>
<div class="section" id="id143">
<h1>})<a class="headerlink" href="#id143" title="Permalink to this headline">¶</a></h1>
<p>To use a custom cookie jar (instead of <cite>request</cite>’s global cookie jar), set <cite>jar</cite> to an instance of <cite>request.jar()</cite> (either in <cite>defaults</cite> or <cite>options</cite>)</p>
<p><a href="#id144"><span class="problematic" id="id145">``</span></a><a href="#id146"><span class="problematic" id="id147">`</span></a>js
var j = request.jar()
var request = request.defaults({<a class="reference external" href="jar:j">jar:j</a>})
request(&#8216;<a class="reference external" href="http://www.google.com">http://www.google.com</a>&#8216;, function () {</p>
<blockquote>
<div>request(&#8216;<a class="reference external" href="http://images.google.com">http://images.google.com</a>&#8216;)</div></blockquote>
</div>
<div class="section" id="id148">
<h1>})<a class="headerlink" href="#id148" title="Permalink to this headline">¶</a></h1>
<p>OR</p>
<p><a href="#id149"><span class="problematic" id="id150">``</span></a><a href="#id151"><span class="problematic" id="id152">`</span></a>js
var j = request.jar();
var cookie = request.cookie(&#8216;key1=value1&#8217;);
var url = &#8216;<a class="reference external" href="http://www.google.com">http://www.google.com</a>&#8216;;
j.setCookie(cookie, url);
request({url: url, jar: j}, function () {</p>
<blockquote>
<div>request(&#8216;<a class="reference external" href="http://images.google.com">http://images.google.com</a>&#8216;)</div></blockquote>
</div>
<div class="section" id="id153">
<h1>})<a class="headerlink" href="#id153" title="Permalink to this headline">¶</a></h1>
<p>To use a custom cookie store (such as a
[<cite>FileCookieStore</cite>](<a class="reference external" href="https://github.com/mitsuru/tough-cookie-filestore">https://github.com/mitsuru/tough-cookie-filestore</a>)
which supports saving to and restoring from JSON files), pass it as a parameter
to <cite>request.jar()</cite>:</p>
<p><a href="#id154"><span class="problematic" id="id155">``</span></a><a href="#id156"><span class="problematic" id="id157">`</span></a>js
var FileCookieStore = require(&#8216;tough-cookie-filestore&#8217;);
// NOTE - currently the &#8216;cookies.json&#8217; file must already exist!
var j = request.jar(new FileCookieStore(&#8216;cookies.json&#8217;));
request = request.defaults({ jar : j })
request(&#8216;<a class="reference external" href="http://www.google.com">http://www.google.com</a>&#8216;, function() {</p>
<blockquote>
<div>request(&#8216;<a class="reference external" href="http://images.google.com">http://images.google.com</a>&#8216;)</div></blockquote>
</div>
<div class="section" id="id158">
<h1>})<a class="headerlink" href="#id158" title="Permalink to this headline">¶</a></h1>
<p>The cookie store must be a
[<cite>tough-cookie</cite>](<a class="reference external" href="https://github.com/goinstant/tough-cookie">https://github.com/goinstant/tough-cookie</a>)
store and it must support synchronous operations; see the
[<cite>CookieStore</cite> API docs](<a class="reference external" href="https://github.com/goinstant/tough-cookie/#cookiestore-api">https://github.com/goinstant/tough-cookie/#cookiestore-api</a>)
for details.</p>
<p>To inspect your cookie jar after a request:</p>
<p><a href="#id159"><span class="problematic" id="id160">``</span></a><a href="#id161"><span class="problematic" id="id162">`</span></a>js
var j = request.jar()
request({url: &#8216;<a class="reference external" href="http://www.google.com">http://www.google.com</a>&#8216;, jar: j}, function () {</p>
<blockquote>
<div>var cookie_string = j.getCookieString(url); // &#8220;key1=value1; key2=value2; ...&#8221;
var cookies = j.getCookies(url);
// [{key: &#8216;key1&#8217;, value: &#8216;value1&#8217;, domain: &#8220;www.google.com&#8221;, ...}, ...]</div></blockquote>
</div>
<div class="section" id="id163">
<h1>})<a class="headerlink" href="#id163" title="Permalink to this headline">¶</a></h1>
<p>[back to top](#table-of-contents)</p>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright © NFLabs. All rights reserved..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../../../../../../../../../../../../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../../../../../../../../../../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../../../../../../../../../../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../../../../../../../../../../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../../../../../../../../../../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>