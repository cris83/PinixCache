

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>); &mdash; PINIX Cache Docs 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../../../../../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PINIX Cache Docs 1.0 documentation" href="../../../../../../../../../../index.html"/> 

  
  <script src="../../../../../../../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../../../../../../../index.html" class="icon icon-home"> PINIX Cache Docs
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../Global.html">Global</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../Origin.html">Origin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../VHost.html">VHost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../VHost-Proxy.html">Virtual Host Proxy</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../../../../../../../index.html">PINIX Cache Docs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../../../../../../../index.html">Docs</a> &raquo;</li>
      
    <li>);</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../../../../../../../_sources/_themes/sphinx_rtd_theme-master/node_modules/grunt-contrib-jade/node_modules/jade/node_modules/monocle/node_modules/readdirp/README.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p># readdirp [![Build Status](<a class="reference external" href="https://secure.travis-ci.org/thlorenz/readdirp.png)](http://travis-ci.org/thlorenz/readdirp">https://secure.travis-ci.org/thlorenz/readdirp.png)](http://travis-ci.org/thlorenz/readdirp</a>)</p>
<p>Recursive version of [fs.readdir](<a class="reference external" href="http://nodejs.org/docs/latest/api/fs.html#fs_fs_readdir_path_callback">http://nodejs.org/docs/latest/api/fs.html#fs_fs_readdir_path_callback</a>). Exposes a <strong>stream api</strong>.</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>javascript
var readdirp = require(&#8216;readdirp&#8217;);</p>
<blockquote>
<div>, path = require(&#8216;path&#8217;)
, es = require(&#8216;event-stream&#8217;);</div></blockquote>
<p>// print out all JavaScript files along with their size</p>
<p>var stream = readdirp({ root: path.join(__dirname), fileFilter: &#8216;<a href="#id5"><span class="problematic" id="id6">*</span></a>.js&#8217; });
stream</p>
<blockquote>
<div><dl class="docutils">
<dt>.on(&#8216;warn&#8217;, function (err) {</dt>
<dd>console.error(&#8216;non-fatal error&#8217;, err);
// optionally call stream.destroy() here in order to abort and cause &#8216;close&#8217; to be emitted</dd>
</dl>
<p>})
.on(&#8216;error&#8217;, function (err) { console.error(&#8216;fatal error&#8217;, err); })
.pipe(es.mapSync(function (entry) {</p>
<blockquote>
<div>return { path: entry.path, size: entry.stat.size };</div></blockquote>
<p>}))
.pipe(es.stringify())
.pipe(process.stdout);</p>
</div></blockquote>
<p><a href="#id7"><span class="problematic" id="id8">``</span></a><a href="#id9"><span class="problematic" id="id10">`</span></a></p>
<p>Meant to be one of the recursive versions of [fs](<a class="reference external" href="http://nodejs.org/docs/latest/api/fs.html">http://nodejs.org/docs/latest/api/fs.html</a>) functions, e.g., like [mkdirp](<a class="reference external" href="https://github.com/substack/node-mkdirp">https://github.com/substack/node-mkdirp</a>).</p>
<p><strong>Table of Contents</strong>  <em>generated with [DocToc](http://doctoc.herokuapp.com/)</em></p>
<ul>
<li><p class="first">[Installation](#installation)</p>
</li>
<li><dl class="first docutils">
<dt>[API](#api)</dt>
<dd><ul class="first last">
<li><p class="first">[entry stream](#entry-stream)</p>
</li>
<li><p class="first">[options](#options)</p>
</li>
<li><p class="first">[entry info](#entry-info)</p>
</li>
<li><p class="first">[Filters](#filters)</p>
</li>
<li><dl class="first docutils">
<dt>[Callback API](#callback-api)</dt>
<dd><ul class="first last simple">
<li>[allProcessed ](#allprocessed)</li>
<li>[fileProcessed](#fileprocessed)</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>[More Examples](#more-examples)</dt>
<dd><ul class="first last simple">
<li>[stream api](#stream-api)</li>
<li>[stream api pipe](#stream-api-pipe)</li>
<li>[grep](#grep)</li>
<li>[using callback api](#using-callback-api)</li>
<li>[tests](#tests)</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p># Installation</p>
<blockquote>
<div>npm install readdirp</div></blockquote>
<p># API</p>
<p><strong>*var entryStream = readdirp (options)*</strong></p>
<p>Reads given root recursively and returns a <cite>stream</cite> of [entry info](#entry-info)s.</p>
<p>## entry stream</p>
<p>Behaves as follows:</p>
<ul class="simple">
<li><cite>emit(&#8216;data&#8217;)</cite> passes an [entry info](#entry-info) whenever one is found</li>
<li><cite>emit(&#8216;warn&#8217;)</cite> passes a non-fatal <cite>Error</cite> that prevents a file/directory from being processed (i.e., if it is
inaccessible to the user)</li>
<li><cite>emit(&#8216;error&#8217;)</cite> passes a fatal <cite>Error</cite> which also ends the stream (i.e., when illegal options where passed)</li>
<li><cite>emit(&#8216;end&#8217;)</cite> called when all entries were found and no more will be emitted (i.e., we are done)</li>
<li><cite>emit(&#8216;close&#8217;)</cite> called when the stream is destroyed via <cite>stream.destroy()</cite> (which could be useful if you want to
manually abort even on a non fatal error) - at that point the stream is no longer <cite>readable</cite> and no more entries,
warning or errors are emitted</li>
<li>the stream is <cite>paused</cite> initially in order to allow <cite>pipe</cite> and <cite>on</cite> handlers be connected before data or errors are
emitted</li>
<li>the stream is <cite>resumed</cite> automatically during the next event loop</li>
<li>to learn more about streams, consult the [stream-handbook](<a class="reference external" href="https://github.com/substack/stream-handbook">https://github.com/substack/stream-handbook</a>)</li>
</ul>
<p>## options</p>
<ul class="simple">
<li><strong>root</strong>: path in which to start reading and recursing into subdirectories</li>
<li><strong>fileFilter</strong>: filter to include/exclude files found (see [Filters](#filters) for more)</li>
<li><strong>directoryFilter</strong>: filter to include/exclude directories found and to recurse into (see [Filters](#filters) for more)</li>
<li><strong>depth</strong>: depth at which to stop recursing even if more subdirectories are found</li>
</ul>
<p>## entry info</p>
<p>Has the following properties:</p>
<ul>
<li><p class="first"><strong>parentDir</strong>     :  directory in which entry was found (relative to given root)</p>
</li>
<li><p class="first"><strong>fullParentDir</strong> :  full path to parent directory</p>
</li>
<li><p class="first"><strong>name</strong>          :  name of the file/directory</p>
</li>
<li><p class="first"><strong>path</strong>          :  path to the file/directory (relative to given root)</p>
</li>
<li><p class="first"><strong>fullPath</strong>      :  full path to the file/directory found</p>
</li>
<li><p class="first"><strong>stat</strong>          :  built in [stat object](<a class="reference external" href="http://nodejs.org/docs/v0.4.9/api/fs.html#fs.Stats">http://nodejs.org/docs/v0.4.9/api/fs.html#fs.Stats</a>)</p>
</li>
<li><p class="first"><strong>Example</strong>: (assuming root was <cite>/User/dev/readdirp</cite>)</p>
<blockquote>
<div><p>parentDir     :  &#8216;test/bed/root_dir1&#8217;,
fullParentDir :  &#8216;/User/dev/readdirp/test/bed/root_dir1&#8217;,
name          :  &#8216;root_dir1_subdir1&#8217;,
path          :  &#8216;test/bed/root_dir1/root_dir1_subdir1&#8217;,
fullPath      :  &#8216;/User/dev/readdirp/test/bed/root_dir1/root_dir1_subdir1&#8217;,
stat          :  [ ... ]</p>
</div></blockquote>
</li>
</ul>
<p>## Filters</p>
<p>There are three different ways to specify filters for files and directories respectively.</p>
<ul>
<li><p class="first"><strong>function</strong>: a function that takes an entry info as a parameter and returns true to include or false to exclude the entry</p>
</li>
<li><dl class="first docutils">
<dt><strong>glob string</strong>: a string (e.g., <cite>*.js</cite>) which is matched using [minimatch](<a class="reference external" href="https://github.com/isaacs/minimatch">https://github.com/isaacs/minimatch</a>), so go there for more</dt>
<dd><p class="first">information.</p>
<p>Globstars (<cite>**</cite>) are not supported since specifiying a recursive pattern for an already recursive function doesn&#8217;t make sense.</p>
<p class="last">Negated globs (as explained in the minimatch documentation) are allowed, e.g., <cite>!*.txt</cite> matches everything but text files.</p>
</dd>
</dl>
</li>
<li><p class="first"><strong>array of glob strings</strong>: either need to be all inclusive or all exclusive (negated) patterns otherwise an error is thrown.</p>
<blockquote>
<div><p><cite>[ &#8216;*.json&#8217;, &#8216;*.js&#8217; ]</cite> includes all JavaScript and Json files.</p>
<p><cite>[ &#8216;!.git&#8217;, &#8216;!node_modules&#8217; ]</cite> includes all directories except the &#8216;.git&#8217; and &#8216;node_modules&#8217;.</p>
</div></blockquote>
</li>
</ul>
<p>Directories that do not pass a filter will not be recursed into.</p>
<p>## Callback API</p>
<p>Although the stream api is recommended, readdirp also exposes a callback based api.</p>
<p><strong>*readdirp (options, callback1 [, callback2])*</strong></p>
<p>If callback2 is given, callback1 functions as the <strong>fileProcessed</strong> callback, and callback2 as the <strong>allProcessed</strong> callback.</p>
<p>If only callback1 is given, it functions as the <strong>allProcessed</strong> callback.</p>
<p>### allProcessed</p>
<ul class="simple">
<li>function with err and res parameters, e.g., <cite>function (err, res) { ... }</cite></li>
<li><strong>err</strong>: array of errors that occurred during the operation, <strong>res may still be present, even if errors occurred</strong></li>
<li><strong>res</strong>: collection of file/directory [entry infos](#entry-info)</li>
</ul>
<p>### fileProcessed</p>
<ul class="simple">
<li>function with [entry info](#entry-info) parameter e.g., <cite>function (entryInfo) { ... }</cite></li>
</ul>
<p># More Examples</p>
<p><cite>on(&#8216;error&#8217;, ..)</cite>, <cite>on(&#8216;warn&#8217;, ..)</cite> and <cite>on(&#8216;end&#8217;, ..)</cite> handling omitted for brevity</p>
<p><a href="#id11"><span class="problematic" id="id12">``</span></a><a href="#id13"><span class="problematic" id="id14">`</span></a>javascript
var readdirp = require(&#8216;readdirp&#8217;);</p>
<p>// Glob file filter
readdirp({ root: &#8216;./test/bed&#8217;, fileFilter: &#8216;<a href="#id15"><span class="problematic" id="id16">*</span></a>.js&#8217; })</p>
<blockquote>
<div><dl class="docutils">
<dt>.on(&#8216;data&#8217;, function (entry) {</dt>
<dd>// do something with each JavaScript file entry</dd>
</dl>
<p>});</p>
</div></blockquote>
<p>// Combined glob file filters
readdirp({ root: &#8216;./test/bed&#8217;, fileFilter: [ &#8216;<em>.js&#8217;, &#8216;</em>.json&#8217; ] })</p>
<blockquote>
<div><dl class="docutils">
<dt>.on(&#8216;data&#8217;, function (entry) {</dt>
<dd>// do something with each JavaScript and Json file entry</dd>
</dl>
<p>});</p>
</div></blockquote>
<p>// Combined negated directory filters
readdirp({ root: &#8216;./test/bed&#8217;, directoryFilter: [ &#8216;!.git&#8217;, &#8216;!*modules&#8217; ] })</p>
<blockquote>
<div><dl class="docutils">
<dt>.on(&#8216;data&#8217;, function (entry) {</dt>
<dd>// do something with each file entry found outside &#8216;.git&#8217; or any modules directory</dd>
</dl>
<p>});</p>
</div></blockquote>
<p>// Function directory filter
readdirp({ root: &#8216;./test/bed&#8217;, directoryFilter: function (di) { return di.name.length === 9; } })</p>
<blockquote>
<div><dl class="docutils">
<dt>.on(&#8216;data&#8217;, function (entry) {</dt>
<dd>// do something with each file entry found inside directories whose name has length 9</dd>
</dl>
<p>});</p>
</div></blockquote>
<p>// Limiting depth
readdirp({ root: &#8216;./test/bed&#8217;, depth: 1 })</p>
<blockquote>
<div><dl class="docutils">
<dt>.on(&#8216;data&#8217;, function (entry) {</dt>
<dd>// do something with each file entry found up to 1 subdirectory deep</dd>
</dl>
<p>});</p>
</div></blockquote>
<p>// callback api
readdirp(</p>
<blockquote>
<div><blockquote>
<div>{ root: &#8216;.&#8217; }</div></blockquote>
<dl class="docutils">
<dt>, function(fileInfo) {</dt>
<dd><blockquote class="first">
<div>// do something with file entry here</div></blockquote>
<p class="last">}</p>
</dd>
<dt>, function (err, res) {</dt>
<dd><blockquote class="first">
<div>// all done, move on or do final step for all file entries here</div></blockquote>
<p class="last">}</p>
</dd>
</dl>
</div></blockquote>
<div class="section" id="id17">
<h1>);<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h1>
<p>Try more examples by following [instructions](<a class="reference external" href="https://github.com/thlorenz/readdirp/blob/master/examples/Readme.md">https://github.com/thlorenz/readdirp/blob/master/examples/Readme.md</a>)
on how to get going.</p>
<p>## stream api</p>
<p>[stream-api.js](<a class="reference external" href="https://github.com/thlorenz/readdirp/blob/master/examples/stream-api.js">https://github.com/thlorenz/readdirp/blob/master/examples/stream-api.js</a>)</p>
<p>Demonstrates error and data handling by listening to events emitted from the readdirp stream.</p>
<p>## stream api pipe</p>
<p>[stream-api-pipe.js](<a class="reference external" href="https://github.com/thlorenz/readdirp/blob/master/examples/stream-api-pipe.js">https://github.com/thlorenz/readdirp/blob/master/examples/stream-api-pipe.js</a>)</p>
<p>Demonstrates error handling by listening to events emitted from the readdirp stream and how to pipe the data stream into
another destination stream.</p>
<p>## grep</p>
<p>[grep.js](<a class="reference external" href="https://github.com/thlorenz/readdirp/blob/master/examples/grep.js">https://github.com/thlorenz/readdirp/blob/master/examples/grep.js</a>)</p>
<p>Very naive implementation of grep, for demonstration purposes only.</p>
<p>## using callback api</p>
<p>[callback-api.js](<a class="reference external" href="https://github.com/thlorenz/readdirp/blob/master/examples/callback-api.js">https://github.com/thlorenz/readdirp/blob/master/examples/callback-api.js</a>)</p>
<p>Shows how to pass callbacks in order to handle errors and/or data.</p>
<p>## tests</p>
<p>The [readdirp tests](<a class="reference external" href="https://github.com/thlorenz/readdirp/blob/master/test/readdirp.js">https://github.com/thlorenz/readdirp/blob/master/test/readdirp.js</a>) also will give you a good idea on
how things work.</p>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright © NFLabs. All rights reserved..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../../../../../../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../../../../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../../../../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../../../../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../../../../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>