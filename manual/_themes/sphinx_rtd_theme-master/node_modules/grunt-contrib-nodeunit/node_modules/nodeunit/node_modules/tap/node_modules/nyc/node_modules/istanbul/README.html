

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>&lt;no title&gt; &mdash; PINIX Cache Docs 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../../../../../../../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PINIX Cache Docs 1.0 documentation" href="../../../../../../../../../../../../index.html"/> 

  
  <script src="../../../../../../../../../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../../../../../../../../../index.html" class="icon icon-home"> PINIX Cache Docs
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../Global.html">Global</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../Origin.html">Origin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../VHost.html">VHost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../VHost-Proxy.html">Virtual Host Proxy</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../../../../../../../../../index.html">PINIX Cache Docs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../../../../../../../../../index.html">Docs</a> &raquo;</li>
      
    <li>&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../../../../../../../../../_sources/_themes/sphinx_rtd_theme-master/node_modules/grunt-contrib-nodeunit/node_modules/nodeunit/node_modules/tap/node_modules/nyc/node_modules/istanbul/README.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p>## Istanbul - a JS code coverage tool written in JS</p>
<p>[![Build Status](<a class="reference external" href="https://secure.travis-ci.org/gotwarlost/istanbul.png)](http://travis-ci.org/gotwarlost/istanbul">https://secure.travis-ci.org/gotwarlost/istanbul.png)](http://travis-ci.org/gotwarlost/istanbul</a>)
[![Dependency Status](<a class="reference external" href="https://gemnasium.com/gotwarlost/istanbul.png)](https://gemnasium.com/gotwarlost/istanbul">https://gemnasium.com/gotwarlost/istanbul.png)](https://gemnasium.com/gotwarlost/istanbul</a>)
[![Coverage Status](<a class="reference external" href="https://img.shields.io/coveralls/gotwarlost/istanbul.svg)](https://coveralls.io/r/gotwarlost/istanbul?branch=master">https://img.shields.io/coveralls/gotwarlost/istanbul.svg)](https://coveralls.io/r/gotwarlost/istanbul?branch=master</a>)</p>
<p>[![NPM](<a class="reference external" href="https://nodei.co/npm/istanbul.png?downloads=true)](https://nodei.co/npm/istanbul/">https://nodei.co/npm/istanbul.png?downloads=true)](https://nodei.co/npm/istanbul/</a>)</p>
<ul class="simple">
<li>[Features and use cases](#features)</li>
<li>[Getting started and configuration](#getting-started)</li>
<li>[The command line](#the-command-line)</li>
<li>[Ignoring code for coverage](#ignoring-code-for-coverage)</li>
<li>[API](#api)</li>
<li>[Changelog](<a class="reference external" href="https://github.com/gotwarlost/istanbul/blob/master/CHANGELOG.md">https://github.com/gotwarlost/istanbul/blob/master/CHANGELOG.md</a>)</li>
<li>[License and credits](#license)</li>
</ul>
<p>### Features</p>
<ul class="simple">
<li>All-javascript instrumentation library that tracks <a href="#id1"><span class="problematic" id="id2">**</span></a>statement, branch,</li>
</ul>
<p>and function coverage**.
* <strong>Module loader hooks</strong> to instrument code on the fly
* <strong>Command line tools</strong> to run node unit tests &#8220;with coverage turned on&#8221; and no cooperation
whatsoever from the test runner
* Multiple report formats: <strong>HTML</strong>, <strong>LCOV</strong>, <strong>Cobertura</strong> and more.
* Ability to use as [middleware](<a class="reference external" href="https://github.com/gotwarlost/istanbul-middleware">https://github.com/gotwarlost/istanbul-middleware</a>) when serving JS files that need to be tested on the browser.
* Can be used on the <strong>command line</strong> as well as a <strong>library</strong>
* Based on the awesome <cite>esprima</cite> parser and the equally awesome <cite>escodegen</cite> code generator
* Well-tested on node (prev, current and next versions) and the browser (instrumentation library only)</p>
<p>### Use cases</p>
<p>Supports the following use cases and more</p>
<ul class="simple">
<li>transparent coverage of nodejs unit tests</li>
<li>instrumentation/ reporting of files in batch mode for browser tests</li>
<li>Server side code coverage for nodejs by embedding it as [custom middleware](<a class="reference external" href="https://github.com/gotwarlost/istanbul-middleware">https://github.com/gotwarlost/istanbul-middleware</a>)</li>
</ul>
<p>### Getting started</p>
<blockquote>
<div>$ npm install -g istanbul</div></blockquote>
<p>The best way to see it in action is to run node unit tests. Say you have a test
script <cite>test.js</cite> that runs all tests for your node project without coverage.</p>
<p>Simply:</p>
<blockquote>
<div>$ cd /path/to/your/source/root
$ istanbul cover test.js</div></blockquote>
<p>and this should produce a <cite>coverage.json</cite>, <cite>lcov.info</cite> and <cite>lcov-report/*html</cite> under <cite>./coverage</cite></p>
<p>Sample of code coverage reports produced by this tool (for this tool!):</p>
<p>[HTML reports](<a class="reference external" href="http://gotwarlost.github.com/istanbul/public/coverage/lcov-report/index.html">http://gotwarlost.github.com/istanbul/public/coverage/lcov-report/index.html</a>)</p>
<p>### Configuring</p>
<p>Drop a <cite>.istanbul.yml</cite> file at the top of the source tree to configure istanbul.
<cite>istanbul help config</cite> tells you more about the config file format.</p>
<p>### The command line</p>
<blockquote>
<div>$ istanbul help</div></blockquote>
<p>gives you detailed help on all commands.</p>
<p><a href="#id3"><span class="problematic" id="id4">``</span></a>`
Usage: istanbul help config | &lt;command&gt;</p>
<p><cite>config</cite> provides help with istanbul configuration</p>
<p>Available commands are:</p>
<blockquote>
<div><dl class="docutils">
<dt>check-coverage</dt>
<dd>checks overall/per-file coverage against thresholds from coverage
JSON files. Exits 1 if thresholds are not met, 0 otherwise</dd>
<dt>cover   transparently adds coverage information to a node command. Saves</dt>
<dd>coverage.json and reports at the end of execution</dd>
</dl>
<p>help    shows help</p>
<dl class="docutils">
<dt>instrument</dt>
<dd>instruments a file or a directory tree and writes the
instrumented code to the desired output location</dd>
<dt>report  writes reports for coverage JSON objects produced in a previous</dt>
<dd>run</dd>
<dt>test    cover a node command only when npm_config_coverage is set. Use in</dt>
<dd>an <cite>npm test</cite> script for conditional coverage</dd>
</dl>
</div></blockquote>
<p>Command names can be abbreviated as long as the abbreviation is unambiguous
<a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<p>To get detailed help for a command and what command-line options it supports, run:</p>
<blockquote>
<div>istanbul help &lt;command&gt;</div></blockquote>
<p>(Most of the command line options are not covered in this document.)</p>
<p>#### The <cite>cover</cite> command</p>
<blockquote>
<div>$ istanbul cover my-test-script.js &#8211; my test args
# note the &#8211; between the command name and the arguments to be passed</div></blockquote>
<p>The <cite>cover</cite> command can be used to get a coverage object and reports for any arbitrary
node script. By default, coverage information is written under <cite>./coverage</cite> - this
can be changed using command-line options.</p>
<p>The <cite>cover</cite> command can also be passed an optional <cite>&#8211;handle-sigint</cite> flag to
enable writing reports when a user triggers a manual SIGINT of the process that is
being covered. This can be useful when you are generating coverage for a long lived process.</p>
<p>#### The <cite>test</cite> command</p>
<p>The <cite>test</cite> command has almost the same behavior as the <cite>cover</cite> command, except that
it skips coverage unless the <cite>npm_config_coverage</cite> environment variable is set.</p>
<p><strong>This command is deprecated</strong> since the latest versions of npm do not seem to
set the <cite>npm_config_coverage</cite> variable.</p>
<p>#### The <cite>instrument</cite> command</p>
<p>Instruments a single JS file or an entire directory tree and produces an output
directory tree with instrumented code. This should not be required for running node
unit tests but is useful for tests to be run on the browser.</p>
<p>#### The <cite>report</cite> command</p>
<p>Writes reports using <cite>coverage*.json</cite> files as the source of coverage information.
Reports are available in multiple formats and can be individually configured
using the istanbul config file. See <cite>istanbul help report</cite> for more details.</p>
<p>#### The <cite>check-coverage</cite> command</p>
<p>Checks the coverage of statements, functions, branches, and lines against the
provided thresholds. Positive thresholds are taken to be the minimum percentage
required and negative numbers are taken to be the number of uncovered entities
allowed.</p>
<p>### Ignoring code for coverage</p>
<ul class="simple">
<li>Skip an <cite>if</cite> or <cite>else</cite> path with <cite>/* istanbul ignore if */</cite> or <cite>/* istanbul ignore else */</cite> respectively.</li>
<li>For all other cases, skip the next &#8216;thing&#8217; in the source with: <cite>/* istanbul ignore next */</cite></li>
</ul>
<p>See [ignoring-code-for-coverage.md](ignoring-code-for-coverage.md) for the spec.</p>
<p>### API</p>
<p>All the features of istanbul can be accessed as a library.</p>
<p>#### Instrument code</p>
<dl class="docutils">
<dt><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a>javascript</dt>
<dd><p class="first">var istanbul = require(&#8216;istanbul&#8217;);
var instrumenter = new istanbul.Instrumenter();</p>
<dl class="last docutils">
<dt>var generatedCode = instrumenter.instrumentSync(&#8216;function meaningOfLife() { return 42; }&#8217;,</dt>
<dd>&#8216;filename.js&#8217;);</dd>
</dl>
</dd>
</dl>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a></p>
<p>#### Generate reports given a bunch of coverage JSON objects</p>
<dl class="docutils">
<dt><a href="#id17"><span class="problematic" id="id18">``</span></a><a href="#id19"><span class="problematic" id="id20">`</span></a>javascript</dt>
<dd><dl class="first docutils">
<dt>var istanbul = require(&#8216;istanbul&#8217;),</dt>
<dd>collector = new istanbul.Collector(),
reporter = new istanbul.Reporter(),
sync = false;</dd>
</dl>
<p>collector.add(obj1);
collector.add(obj2); //etc.</p>
<p>reporter.add(&#8216;text&#8217;);
reporter.addAll([ &#8216;lcov&#8217;, &#8216;clover&#8217; ]);
reporter.write(collector, sync, function () {</p>
<blockquote>
<div>console.log(&#8216;All reports generated&#8217;);</div></blockquote>
<p class="last">});</p>
</dd>
</dl>
<p><a href="#id21"><span class="problematic" id="id22">``</span></a><a href="#id23"><span class="problematic" id="id24">`</span></a></p>
<p>For the gory details consult the [public API](<a class="reference external" href="http://gotwarlost.github.com/istanbul/public/apidocs/index.html">http://gotwarlost.github.com/istanbul/public/apidocs/index.html</a>)</p>
<p>### Multiple Process Usage</p>
<p>Istanbul can be used in a multiple process environment by running each process
with Istanbul, writing a unique coverage file for each process, and combining
the results when generating reports. The method used to perform this will
depend on the process forking API used. For example when using the
[cluster module](<a class="reference external" href="http://nodejs.org/api/cluster.html">http://nodejs.org/api/cluster.html</a>) you must setup the master
to start child processes with Istanbul coverage, disable reporting, and output
coverage files that include the PID in the filename.  Before each run you may
need to clear out the coverage data directory.</p>
<dl class="docutils">
<dt><a href="#id25"><span class="problematic" id="id26">``</span></a><a href="#id27"><span class="problematic" id="id28">`</span></a>javascript</dt>
<dd><dl class="first docutils">
<dt>if(cluster.isMaster) {</dt>
<dd><p class="first">// setup cluster if running with istanbul coverage
if(process.env.running_under_istanbul) {</p>
<blockquote>
<div><p>// use coverage for forked process
// disabled reporting and output for child process
// enable pid in child process coverage filename
cluster.setupMaster({</p>
<blockquote>
<div><p>exec: &#8216;./node_modules/.bin/istanbul&#8217;,
args: [</p>
<blockquote>
<div>&#8216;cover&#8217;, &#8216;&#8211;report&#8217;, &#8216;none&#8217;, &#8216;&#8211;print&#8217;, &#8216;none&#8217;, &#8216;&#8211;include-pid&#8217;,
process.argv[1], &#8216;&#8211;&#8217;].concat(process.argv.slice(2))</div></blockquote>
</div></blockquote>
<p>});</p>
</div></blockquote>
<p class="last">}
// ...
// ... cluster.fork();
// ...</p>
</dd>
<dt>} else {</dt>
<dd>// ... worker code</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<p><a href="#id29"><span class="problematic" id="id30">``</span></a><a href="#id31"><span class="problematic" id="id32">`</span></a></p>
<p>### Coverage.json</p>
<p>For details on the format of the coverage.json object, [see here](./coverage.json.md).</p>
<p>### License</p>
<p>istanbul is licensed under the [BSD License](<a class="reference external" href="http://github.com/gotwarlost/istanbul/raw/master/LICENSE">http://github.com/gotwarlost/istanbul/raw/master/LICENSE</a>).</p>
<p>### Third-party libraries</p>
<p>The following third-party libraries are used by this module:</p>
<ul class="simple">
<li>abbrev: <a class="reference external" href="https://github.com/isaacs/abbrev-js">https://github.com/isaacs/abbrev-js</a> -  to handle command abbreviations</li>
<li>async: <a class="reference external" href="https://github.com/caolan/async">https://github.com/caolan/async</a> - for parallel instrumentation of files</li>
<li>escodegen: <a class="reference external" href="https://github.com/Constellation/escodegen">https://github.com/Constellation/escodegen</a> - for JS code generation</li>
<li>esprima: <a class="reference external" href="https://github.com/ariya/esprima">https://github.com/ariya/esprima</a> - for JS parsing</li>
<li>fileset: <a class="reference external" href="https://github.com/mklabs/node-fileset">https://github.com/mklabs/node-fileset</a> - for loading and matching path expressions</li>
<li>handlebars: <a class="reference external" href="https://github.com/wycats/handlebars.js/">https://github.com/wycats/handlebars.js/</a> - for report template expansion</li>
<li>js-yaml: <a class="reference external" href="https://github.com/nodeca/js-yaml">https://github.com/nodeca/js-yaml</a> - for YAML config file load</li>
<li>mkdirp: <a class="reference external" href="https://github.com/substack/node-mkdirp">https://github.com/substack/node-mkdirp</a> - to create output directories</li>
<li>nodeunit: <a class="reference external" href="https://github.com/caolan/nodeunit">https://github.com/caolan/nodeunit</a> - dev dependency for unit tests</li>
<li>nopt: <a class="reference external" href="https://github.com/isaacs/nopt">https://github.com/isaacs/nopt</a> - for option parsing</li>
<li>once: <a class="reference external" href="https://github.com/isaacs/once">https://github.com/isaacs/once</a> - to ensure callbacks are called once</li>
<li>resolve: <a class="reference external" href="https://github.com/substack/node-resolve">https://github.com/substack/node-resolve</a> - for resolving a post-require hook module name into its main file.</li>
<li>rimraf - <a class="reference external" href="https://github.com/isaacs/rimraf">https://github.com/isaacs/rimraf</a> - dev dependency for unit tests</li>
<li>which: <a class="reference external" href="https://github.com/isaacs/node-which">https://github.com/isaacs/node-which</a> - to resolve a node command to a file for the <cite>cover</cite> command</li>
<li>wordwrap: <a class="reference external" href="https://github.com/substack/node-wordwrap">https://github.com/substack/node-wordwrap</a> - for prettier help</li>
<li>prettify: <a class="reference external" href="http://code.google.com/p/google-code-prettify/">http://code.google.com/p/google-code-prettify/</a> - for syntax colored HTML reports. Files checked in under <cite>lib/vendor/</cite></li>
</ul>
<p>### Inspired by</p>
<ul class="simple">
<li>YUI test coverage - <a class="reference external" href="https://github.com/yui/yuitest">https://github.com/yui/yuitest</a> - the grand-daddy of JS coverage tools. Istanbul has been specifically designed to offer an alternative to this library with an easy migration path.</li>
<li>cover: <a class="reference external" href="https://github.com/itay/node-cover">https://github.com/itay/node-cover</a> - the inspiration for the <cite>cover</cite> command, modeled after the <cite>run</cite> command in that tool. The coverage methodology used by istanbul is quite different, however</li>
</ul>
<p>### Shout out to</p>
<blockquote>
<div><ul class="simple">
<li>[mfncooper](<a class="reference external" href="https://github.com/mfncooper">https://github.com/mfncooper</a>) - for great brainstorming discussions</li>
<li>[reid](<a class="reference external" href="https://github.com/reid">https://github.com/reid</a>), [davglass](<a class="reference external" href="https://github.com/davglass">https://github.com/davglass</a>), the YUI dudes, for interesting conversations, encouragement, support and gentle pressure to get it done :)</li>
</ul>
</div></blockquote>
<p>### Why the funky name?</p>
<p>Since all the good ones are taken. Comes from the loose association of ideas across
coverage, carpet-area coverage, the country that makes good carpets and so on...</p>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright © NFLabs. All rights reserved..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../../../../../../../../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../../../../../../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../../../../../../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../../../../../../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../../../../../../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>