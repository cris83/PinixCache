

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>&lt;no title&gt; &mdash; PINIX Cache Docs 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../../../../../../../../../../../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PINIX Cache Docs 1.0 documentation" href="../../../../../../../../../../../../../../../../index.html"/> 

  
  <script src="../../../../../../../../../../../../../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../../../../../../../../../../../../../index.html" class="icon icon-home"> PINIX Cache Docs
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../../../../../../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../../../../../Global.html">Global</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../../../../../Origin.html">Origin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../../../../../VHost.html">VHost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../../../../../VHost-Proxy.html">Virtual Host Proxy</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../../../../../../../../../../../../../index.html">PINIX Cache Docs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../../../../../../../../../../../../../index.html">Docs</a> &raquo;</li>
      
    <li>&lt;no title&gt;</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../../../../../../../../../../../../../_sources/_themes/sphinx_rtd_theme-master/node_modules/grunt-contrib-imagemin/node_modules/imagemin/node_modules/imagemin-gifsicle/node_modules/gifsicle/node_modules/bin-wrapper/node_modules/download/node_modules/through2/README.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p># through2</p>
<p>&lt;!&#8211;</p>
<p>soon ...</p>
<p>[![Build Status](<a class="reference external" href="https://secure.travis-ci.org/rvagg/through2.png)](http://travis-ci.org/rvagg/through2">https://secure.travis-ci.org/rvagg/through2.png)](http://travis-ci.org/rvagg/through2</a>)</p>
<p>[![Build Status](<a class="reference external" href="https://saucelabs.com/browser-matrix/through2-sauce.svg)](https://travis-ci.org/rvagg/through2">https://saucelabs.com/browser-matrix/through2-sauce.svg)](https://travis-ci.org/rvagg/through2</a>)</p>
<p>&#8211;&gt;</p>
<p>[![NPM](<a class="reference external" href="https://nodei.co/npm/through2.png?compact=true)](https://nodei.co/npm/through2/">https://nodei.co/npm/through2.png?compact=true)](https://nodei.co/npm/through2/</a>)</p>
<p>&lt;!&#8211;
not happy with these, we need to peg to <a class="reference external" href="mailto:readable-stream&#37;&#52;&#48;1&#46;0&#46;x">readable-stream<span>&#64;</span>1<span>&#46;</span>0<span>&#46;</span>x</a> so it&#8217;ll always report out-of-date</p>
<p>[![david-dm](<a class="reference external" href="https://david-dm.org/rvagg/through2.png)](https://david-dm.org/rvagg/through2/">https://david-dm.org/rvagg/through2.png)](https://david-dm.org/rvagg/through2/</a>)
[![david-dm](<a class="reference external" href="https://david-dm.org/rvagg/through2/dev-status.png)](https://david-dm.org/rvagg/through2#info=devDependencies/">https://david-dm.org/rvagg/through2/dev-status.png)](https://david-dm.org/rvagg/through2#info=devDependencies/</a>)
&#8211;&gt;</p>
<p><strong>A tiny wrapper around Node streams.Transform (Streams2) to avoid explicit subclassing noise</strong></p>
<p>Inspired by [Dominic Tarr](<a class="reference external" href="https://github.com/dominictarr)'s">https://github.com/dominictarr)&#8217;s</a> [through](<a class="reference external" href="https://github.com/dominictarr/through">https://github.com/dominictarr/through</a>) in that it&#8217;s so much easier to make a stream out of a function than it is to set up the prototype chain properly: <cite>through(function (chunk) { ... })</cite>.</p>
<p>Note: A <strong>Streams3</strong> version of through2 is available in npm with the tag <cite>&#8220;1.0&#8221;</cite> rather than <cite>&#8220;latest&#8221;</cite> so an <cite>npm install through2</cite> will get you the current Streams2 version (version number is 0.x.x). To use a Streams3 version use <cite>npm install through2&#64;1</cite> to fetch the latest version 1.x.x. More information about Streams2 vs Streams3 and recommendations [here](<a class="reference external" href="http://www.nearform.com/nodecrunch/dont-use-nodes-core-stream-module">http://www.nearform.com/nodecrunch/dont-use-nodes-core-stream-module</a>).</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>js
fs.createReadStream(&#8216;ex.txt&#8217;)</p>
<blockquote>
<div><p>.pipe(through2(function (chunk, enc, callback) {</p>
<blockquote>
<div><blockquote>
<div><dl class="docutils">
<dt>for (var i = 0; i &lt; chunk.length; i++)</dt>
<dd><dl class="first last docutils">
<dt>if (chunk[i] == 97)</dt>
<dd>chunk[i] = 122 // swap &#8216;a&#8217; for &#8216;z&#8217;</dd>
</dl>
</dd>
</dl>
<p>this.push(chunk)</p>
<p>callback()</p>
</div></blockquote>
<p>}))</p>
</div></blockquote>
<p>.pipe(fs.createWriteStream(&#8216;out.txt&#8217;))</p>
</div></blockquote>
<p><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
<p>Or object streams:</p>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a>js
var all = []</p>
<dl class="docutils">
<dt>fs.createReadStream(&#8216;data.csv&#8217;)</dt>
<dd><p class="first">.pipe(csv2())
.pipe(through2.obj(function (chunk, enc, callback) {</p>
<blockquote>
<div><dl class="docutils">
<dt>var data = {</dt>
<dd><blockquote class="first">
<div>name    : chunk[0]</div></blockquote>
<p class="last">, address : chunk[3]
, phone   : chunk[10]</p>
</dd>
</dl>
<p>}</p>
<p>this.push(data)</p>
<p>callback()</p>
</div></blockquote>
<p>}))
.on(&#8216;data&#8217;, function (data) {</p>
<blockquote>
<div>all.push(data)</div></blockquote>
<p>})
.on(&#8216;end&#8217;, function () {</p>
<blockquote>
<div>doSomethingSpecial(all)</div></blockquote>
<p class="last">})</p>
</dd>
</dl>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a></p>
<p>Note that <cite>through2.obj(fn)</cite> is a convenience wrapper around <cite>through2({ objectMode: true }, fn)</cite>.</p>
<p>## API</p>
<p>&lt;b&gt;&lt;code&gt;through2([ options, ] [ transformFunction ] [, flushFunction ])&lt;/code&gt;&lt;/b&gt;</p>
<p>Consult the <strong>[stream.Transform](http://nodejs.org/docs/latest/api/stream.html#stream_class_stream_transform)</strong> documentation for the exact rules of the <cite>transformFunction</cite> (i.e. <cite>this._transform</cite>) and the optional <cite>flushFunction</cite> (i.e. <cite>this._flush</cite>).</p>
<p>### options</p>
<p>The options argument is optional and is passed straight through to <cite>stream.Transform</cite>. So you can use <cite>objectMode:true</cite> if you are processing non-binary streams (or just use <cite>through2.obj()</cite>).</p>
<p>The <cite>options</cite> argument is first, unlike standard convention, because if I&#8217;m passing in an anonymous function then I&#8217;d prefer for the options argument to not get lost at the end of the call:</p>
<p><a href="#id17"><span class="problematic" id="id18">``</span></a><a href="#id19"><span class="problematic" id="id20">`</span></a>js
fs.createReadStream(&#8216;/tmp/important.dat&#8217;)</p>
<blockquote>
<div><p>.pipe(through2({ objectMode: true, allowHalfOpen: false }, function (chunk, enc, cb) {</p>
<blockquote>
<div>this.push(new Buffer(&#8216;wut?&#8217;))
cb()</div></blockquote>
<p>})
.pipe(fs.createWriteStream(&#8216;/tmp/wut.txt&#8217;))</p>
</div></blockquote>
<p><a href="#id21"><span class="problematic" id="id22">``</span></a><a href="#id23"><span class="problematic" id="id24">`</span></a></p>
<p>### transformFunction</p>
<p>The <cite>transformFunction</cite> must have the following signature: <cite>function (chunk, encoding, callback) {}</cite>. A minimal implementation should call the <cite>callback</cite> function to indicate that the transformation is done, even if that transformation means discarding the chunk.</p>
<p>To queue a new chunk, call <cite>this.push(chunk)`&amp;mdash;this can be called as many times as required before the `callback()</cite> if you have multiple pieces to send on.</p>
<p>If you <strong>do not provide a `transformFunction`</strong> then you will get a simple simple pass-through stream.</p>
<p>### flushFunction</p>
<p>The optional <cite>flushFunction</cite> is provided as the last argument (2nd or 3rd, depending on whether you&#8217;ve supplied options) is called just prior to the stream ending. Can be used to finish up any processing that may be in progress.</p>
<p>&lt;b&gt;&lt;code&gt;through2.ctor([ options, ] transformFunction[, flushFunction ])&lt;/code&gt;&lt;/b&gt;</p>
<p>Instead of returning a <cite>stream.Transform</cite> instance, <cite>through2.ctor()</cite> returns a <strong>constructor</strong> for a custom Transform. This is useful when you want to use the same transform logic in multiple instances.</p>
<p><a href="#id25"><span class="problematic" id="id26">``</span></a><a href="#id27"><span class="problematic" id="id28">`</span></a>js
var FToC = through2.ctor({objectMode: true}, function (record, encoding, callback) {</p>
<blockquote>
<div><dl class="docutils">
<dt>if (record.temp != null &amp;&amp; record.unit = &#8220;F&#8221;) {</dt>
<dd>record.temp = ( ( record.temp - 32 ) * 5 ) / 9
record.unit = &#8220;C&#8221;</dd>
</dl>
<p>}
this.push(record)
callback()</p>
</div></blockquote>
<p>})</p>
<p>// Create instances of FToC like so:
var converter = new FToC()
// Or:
var converter = FToC()
// Or specify/override options when you instantiate, if you prefer:
var converter = FToC({objectMode: true})
<a href="#id29"><span class="problematic" id="id30">``</span></a><a href="#id31"><span class="problematic" id="id32">`</span></a></p>
<p>## See Also</p>
<blockquote>
<div><ul class="simple">
<li>[through2-map](<a class="reference external" href="https://github.com/brycebaril/through2-map">https://github.com/brycebaril/through2-map</a>) - Array.prototype.map analog for streams.</li>
<li>[through2-filter](<a class="reference external" href="https://github.com/brycebaril/through2-filter">https://github.com/brycebaril/through2-filter</a>) - Array.prototype.filter analog for streams.</li>
<li>[through2-reduce](<a class="reference external" href="https://github.com/brycebaril/through2-reduce">https://github.com/brycebaril/through2-reduce</a>) - Array.prototype.reduce analog for streams.</li>
<li>[through2-spy](<a class="reference external" href="https://github.com/brycebaril/through2-spy">https://github.com/brycebaril/through2-spy</a>) - Wrapper for simple stream.PassThrough spies.</li>
</ul>
</div></blockquote>
<p>## License</p>
<p><strong>through2</strong> is Copyright (c) 2013 Rod Vagg [&#64;rvagg](<a class="reference external" href="https://twitter.com/rvagg">https://twitter.com/rvagg</a>) and licenced under the MIT licence. All rights not explicitly granted in the MIT license are reserved. See the included LICENSE file for more details.</p>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright © NFLabs. All rights reserved..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../../../../../../../../../../../../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../../../../../../../../../../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../../../../../../../../../../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../../../../../../../../../../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../../../../../../../../../../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>