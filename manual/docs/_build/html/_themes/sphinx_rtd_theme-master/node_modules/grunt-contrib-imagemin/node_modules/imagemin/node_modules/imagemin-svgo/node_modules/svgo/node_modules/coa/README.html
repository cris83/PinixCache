

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>}; &mdash; PINIX Cache Docs 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../../../../../../../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="PINIX Cache Docs 1.0 documentation" href="../../../../../../../../../../../../index.html"/> 

  
  <script src="../../../../../../../../../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../../../../../../../../../index.html" class="icon icon-home"> PINIX Cache Docs
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../Global.html">Global</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../Origin.html">Origin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../VHost.html">VHost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../../../../../../VHost-Proxy.html">Virtual Host Proxy</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../../../../../../../../../index.html">PINIX Cache Docs</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../../../../../../../../../index.html">Docs</a> &raquo;</li>
      
    <li>};</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../../../../../../../../../_sources/_themes/sphinx_rtd_theme-master/node_modules/grunt-contrib-imagemin/node_modules/imagemin/node_modules/imagemin-svgo/node_modules/svgo/node_modules/coa/README.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p># Command-Option-Argument
[![build status](<a class="reference external" href="https://secure.travis-ci.org/veged/coa.png)](http://travis-ci.org/veged/coa">https://secure.travis-ci.org/veged/coa.png)](http://travis-ci.org/veged/coa</a>)</p>
<p>## What is it?</p>
<p>COA is a parser for command line options that aim to get maximum profit from formalization your program API.
Once you write definition in terms of commands, options and arguments you automaticaly get:</p>
<ul class="simple">
<li>Command line help text</li>
<li>Program API for use COA-based programs as modules</li>
<li>Shell completion</li>
<li>Subcommand extendibility by external node modules</li>
</ul>
<p>### Other features</p>
<ul class="simple">
<li>Rich types for options and arguments, such as arrays, boolean flags and required</li>
<li>Commands can be async throught using promising (powered by [Q](<a class="reference external" href="https://github.com/kriskowal/q">https://github.com/kriskowal/q</a>))</li>
<li>Easy submoduling some existing commands to new top-level one</li>
<li>Combined validation and complex parsing of values</li>
</ul>
<p>### TODO</p>
<ul class="simple">
<li>&#8211;Subcommand extendibility&#8211;</li>
<li>Shell completion helpers</li>
<li>Localization</li>
<li>Shell-mode</li>
<li>Configs</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>Aliases</li>
<li>Defaults</li>
</ul>
</div></blockquote>
<p>## Examples</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">``</span></a>javascript
require(&#8216;coa&#8217;).Cmd() // main (top level) command declaration</p>
<blockquote>
<div><p>.name(process.argv[1]) // set top level command name from program name
.title(&#8216;My awesome command line util&#8217;) // title for use in text messages
.helpful() // make command &#8220;helpful&#8221;, i.e. options -h &#8211;help with usage message
.opt() // add some option</p>
<blockquote>
<div><p>.name(&#8216;version&#8217;) // name for use in API
.title(&#8216;Version&#8217;) // title for use in text messages
.short(&#8216;v&#8217;) // short key: -v
.long(&#8216;version&#8217;) // long key: &#8211;version
.flag() // for options without value
.act(function(opts) { // add action for option</p>
<blockquote>
<div><p>// return message as result of action
return JSON.parse(require(&#8216;fs&#8217;).readFileSync(__dirname + &#8216;/package.json&#8217;))</p>
<blockquote>
<div>.version;</div></blockquote>
</div></blockquote>
<p>})
.end() // end option chain and return to main command</p>
</div></blockquote>
<dl class="docutils">
<dt>.cmd()</dt>
<dd>.name(&#8216;subcommand&#8217;)
.apply(require(&#8216;./subcommand&#8217;)) // load subcommand from module
.end()</dd>
<dt>.cmd() // inplace subcommand declaration</dt>
<dd><p class="first">.name(&#8216;othercommand&#8217;)
.title(&#8216;Awesome other subcommand&#8217;)
.helpful()
.opt()</p>
<blockquote>
<div><p>.name(&#8216;input&#8217;)
.title(&#8216;input file, required&#8217;)
.short(&#8216;i&#8217;)
.long(&#8216;input&#8217;)
.val(function(v) { // validator function, also for translate simple values</p>
<blockquote>
<div>return require(&#8216;fs&#8217;).createReadStream(v);</div></blockquote>
<p>})
.req() // make option required
.end() // end option chain and return to command</p>
</div></blockquote>
<p class="last">.end() // end subcommand chain and return to parent command</p>
</dd>
</dl>
<p>.run(process.argv.slice(2)); // parse and run on process.argv</p>
</div></blockquote>
<hr class="docutils" />
<p><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">``</span></a>javascript
// subcommand.js
module.exports = function() {</p>
<blockquote>
<div><dl class="docutils">
<dt>this</dt>
<dd><p class="first">.title(&#8216;Awesome subcommand&#8217;).helpful()
.opt()</p>
<blockquote class="last">
<div>.name(&#8216;output&#8217;)
.title(&#8216;output file&#8217;)
.short(&#8216;o&#8217;)
.long(&#8216;output&#8217;)
.output() // use default preset for &#8220;output&#8221; option declaration
.end()</div></blockquote>
</dd>
</dl>
</div></blockquote>
<div class="section" id="id9">
<h1>};<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h1>
<p>## API reference</p>
<p>### Cmd
Command is a top level entity. Commands may have options and arguments.</p>
<p>#### Cmd.api
Returns object containing all its subcommands as methods to use from other programs.&lt;br&gt;
<strong>&#64;returns</strong> <em>{Object}</em></p>
<p>#### Cmd.name
Set a canonical command identifier to be used anywhere in the API.&lt;br&gt;
<strong>&#64;param</strong> <em>String</em> <cite>_name</cite> command name&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Cmd</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Cmd.title
Set a long description for command to be used anywhere in text messages.&lt;br&gt;
<strong>&#64;param</strong> <em>String</em> <cite>_title</cite> command title&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Cmd</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Cmd.cmd
Create new or add existing subcommand for current command.&lt;br&gt;
<strong>&#64;param</strong> <em>COA.Cmd</em> <cite>[cmd]</cite> existing command instance&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Cmd</em> new or added subcommand instance</p>
<p>#### Cmd.opt
Create option for current command.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Opt</em> <cite>new</cite> option instance</p>
<p>#### Cmd.arg
Create argument for current command.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Opt</em> <cite>new</cite> argument instance</p>
<p>#### Cmd.act
Add (or set) action for current command.&lt;br&gt;
<strong>&#64;param</strong> <em>Function</em> <cite>act</cite> action function,</p>
<blockquote>
<div><p>invoked in the context of command instance
and has the parameters:&lt;br&gt;</p>
<blockquote>
<div><ul class="simple">
<li><em>Object</em> <cite>opts</cite> parsed options&lt;br&gt;</li>
<li><em>Array</em> <cite>args</cite> parsed arguments&lt;br&gt;</li>
<li><em>Object</em> <cite>res</cite> actions result accumulator&lt;br&gt;</li>
</ul>
</div></blockquote>
<p>It can return rejected promise by Cmd.reject (in case of error)
or any other value treated as result.&lt;br&gt;</p>
</div></blockquote>
<p><strong>&#64;param</strong> <em>{Boolean}</em> [force=false] flag for set action instead add to existings&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Cmd</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Cmd.apply
Apply function with arguments in context of command instance.&lt;br&gt;
<strong>&#64;param</strong> <em>Function</em> <cite>fn`&lt;br&gt;
**&#64;param** *Array* `args`&lt;br&gt;
**&#64;returns** *COA.Cmd* `this</cite> instance (for chainability)</p>
<p>#### Cmd.comp
Set custom additional completion for current command.&lt;br&gt;
<strong>&#64;param</strong> <em>Function</em> <cite>fn</cite> completion generation function,</p>
<blockquote>
<div><p>invoked in the context of command instance.
Accepts parameters:&lt;br&gt;</p>
<blockquote>
<div><ul class="simple">
<li><em>Object</em> <cite>opts</cite> completion options&lt;br&gt;</li>
</ul>
</div></blockquote>
<p>It can return promise or any other value treated as result.&lt;br&gt;</p>
</div></blockquote>
<p><strong>&#64;returns</strong> <em>COA.Cmd</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Cmd.helpful
Make command &#8220;helpful&#8221;, i.e. add -h &#8211;help flags for print usage.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Cmd</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Cmd.completable
Adds shell completion to command, adds &#8220;completion&#8221; subcommand, that makes all the magic.&lt;br&gt;
Must be called only on root command.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Cmd</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Cmd.extendable
Adds ability to extend command by external node modules.&lt;br&gt;
<strong>&#64;param</strong> <em>String</em> <cite>[pattern]</cite> Pattern of modules names to search.</p>
<blockquote>
<div>Should be simple string with <cite>%s</cite> placeholder like <cite>coa-program-%s-subcommand</cite>
or without it —&nbsp;it will be treated as module name prefix then. E.g. <cite>coa-program-</cite>.&lt;br&gt;
Node module should export function or <cite>Cmd</cite> object. Function will be passed
to <cite>Cmd.apply()</cite> method of created subcommand object using <cite>Cmd.cmd()</cite> method. And
<cite>Cmd</cite> object will be passed to <cite>Cmd.cmd()</cite> method.</div></blockquote>
<p><strong>&#64;returns</strong> <em>COA.Cmd</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Cmd.usage
Build full usage text for current command instance.&lt;br&gt;
<strong>&#64;returns</strong> <em>String</em> <cite>usage</cite> text</p>
<p>#### Cmd.run
Parse arguments from simple format like NodeJS process.argv
and run ahead current program, i.e. call process.exit when all actions done.&lt;br&gt;
<strong>&#64;param</strong> <em>Array</em> <cite>argv`&lt;br&gt;
**&#64;returns** *COA.Cmd* `this</cite> instance (for chainability)</p>
<p>#### Cmd.invoke
Invoke specified (or current) command using provided options and arguments.&lt;br&gt;
<strong>&#64;param</strong> <em>String|Array</em> <cite>cmds</cite>  subcommand to invoke (optional)&lt;br&gt;
<strong>&#64;param</strong> <em>Object</em> <cite>opts</cite>  command options (optional)&lt;br&gt;
<strong>&#64;param</strong> <em>Object</em> <cite>args</cite>  command arguments (optional)&lt;br&gt;
<strong>&#64;returns</strong> <em>Q.Promise</em></p>
<p>#### Cmd.reject
Return reject of actions results promise.&lt;br&gt;
Use in .act() for return with error.&lt;br&gt;
<strong>&#64;param</strong> <em>Object</em> <cite>reason</cite> reject reason&lt;br&gt;</p>
<blockquote>
<div>You can customize toString() method and exitCode property
of reason object.&lt;br&gt;</div></blockquote>
<p><strong>&#64;returns</strong> <em>Q.promise</em> rejected promise</p>
<p>#### Cmd.end
Finish chain for current subcommand and return parent command instance.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Cmd</em> <cite>parent</cite> command</p>
<p>### Opt
Option is a named entity. Options may have short and long keys for use from command line.&lt;br&gt;
<strong>&#64;namespace**&lt;br&gt;
**&#64;class</strong> Presents option</p>
<p>#### Opt.name
Set a canonical option identifier to be used anywhere in the API.&lt;br&gt;
<strong>&#64;param</strong> <em>String</em> <cite>_name</cite> option name&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Opt</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Opt.title
Set a long description for option to be used anywhere in text messages.&lt;br&gt;
<strong>&#64;param</strong> <em>String</em> <cite>_title</cite> option title&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Opt</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Opt.short
Set a short key for option to be used with one hyphen from command line.&lt;br&gt;
<strong>&#64;param</strong> <em>String</em> <cite>_short`&lt;br&gt;
**&#64;returns** *COA.Opt* `this</cite> instance (for chainability)</p>
<p>#### Opt.long
Set a short key for option to be used with double hyphens from command line.&lt;br&gt;
<strong>&#64;param</strong> <em>String</em> <cite>_long`&lt;br&gt;
**&#64;returns** *COA.Opt* `this</cite> instance (for chainability)</p>
<p>#### Opt.flag
Make an option boolean, i.e. option without value.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Opt</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Opt.arr
Makes an option accepts multiple values.&lt;br&gt;
Otherwise, the value will be used by the latter passed.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Opt</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Opt.req
Makes an option req.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Opt</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Opt.only
Makes an option to act as a command,
i.e. program will exit just after option action.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Opt</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Opt.val
Set a validation (or value) function for argument.&lt;br&gt;
Value from command line passes through before becoming available from API.&lt;br&gt;
Using for validation and convertion simple types to any values.&lt;br&gt;
<strong>&#64;param</strong> <em>Function</em> <cite>_val</cite> validating function,</p>
<blockquote>
<div>invoked in the context of option instance
and has one parameter with value from command line&lt;br&gt;</div></blockquote>
<p><strong>&#64;returns</strong> <em>COA.Opt</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Opt.def
Set a default value for option.
Default value passed through validation function as ordinary value.&lt;br&gt;
<strong>&#64;param</strong> <em>Object</em> <cite>_def`&lt;br&gt;
**&#64;returns** *COA.Opt* `this</cite> instance (for chainability)</p>
<p>#### Opt.input
Make option value inputting stream.
It&#8217;s add useful validation and shortcut for STDIN.
<strong>&#64;returns</strong> <em>{COA.Opt}</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Opt.output
Make option value outputing stream.&lt;br&gt;
It&#8217;s add useful validation and shortcut for STDOUT.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Opt</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Opt.act
Add action for current option command.
This action is performed if the current option
is present in parsed options (with any value).&lt;br&gt;
<strong>&#64;param</strong> <em>Function</em> <cite>act</cite> action function,</p>
<blockquote>
<div><p>invoked in the context of command instance
and has the parameters:&lt;br&gt;</p>
<blockquote>
<div><ul class="simple">
<li><em>Object</em> <cite>opts</cite> parsed options&lt;br&gt;</li>
<li><em>Array</em> <cite>args</cite> parsed arguments&lt;br&gt;</li>
<li><em>Object</em> <cite>res</cite> actions result accumulator&lt;br&gt;</li>
</ul>
</div></blockquote>
<p>It can return rejected promise by Cmd.reject (in case of error)
or any other value treated as result.&lt;br&gt;</p>
</div></blockquote>
<p><strong>&#64;returns</strong> <em>COA.Opt</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Opt.comp
Set custom additional completion for current option.&lt;br&gt;
<strong>&#64;param</strong> <em>Function</em> <cite>fn</cite> completion generation function,</p>
<blockquote>
<div><p>invoked in the context of command instance.
Accepts parameters:&lt;br&gt;</p>
<blockquote>
<div><ul class="simple">
<li><em>Object</em> <cite>opts</cite> completion options&lt;br&gt;</li>
</ul>
</div></blockquote>
<p>It can return promise or any other value treated as result.&lt;br&gt;</p>
</div></blockquote>
<p><strong>&#64;returns</strong> <em>COA.Opt</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Opt.end
Finish chain for current option and return parent command instance.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Cmd</em> <cite>parent</cite> command</p>
<p>### Arg
Argument is a unnamed entity.&lt;br&gt;
From command line arguments passed as list of unnamed values.</p>
<p>#### Arg.name
Set a canonical argument identifier to be used anywhere in text messages.&lt;br&gt;
<strong>&#64;param</strong> <em>String</em> <cite>_name</cite> argument name&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Arg</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Arg.title
Set a long description for argument to be used anywhere in text messages.&lt;br&gt;
<strong>&#64;param</strong> <em>String</em> <cite>_title</cite> argument title&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Arg</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Arg.arr
Makes an argument accepts multiple values.&lt;br&gt;
Otherwise, the value will be used by the latter passed.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Arg</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Arg.req
Makes an argument req.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Arg</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Arg.val
Set a validation (or value) function for argument.&lt;br&gt;
Value from command line passes through before becoming available from API.&lt;br&gt;
Using for validation and convertion simple types to any values.&lt;br&gt;
<strong>&#64;param</strong> <em>Function</em> <cite>_val</cite> validating function,</p>
<blockquote>
<div>invoked in the context of argument instance
and has one parameter with value from command line&lt;br&gt;</div></blockquote>
<p><strong>&#64;returns</strong> <em>COA.Arg</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Arg.def
Set a default value for argument.
Default value passed through validation function as ordinary value.&lt;br&gt;
<strong>&#64;param</strong> <em>Object</em> <cite>_def`&lt;br&gt;
**&#64;returns** *COA.Arg* `this</cite> instance (for chainability)</p>
<p>#### Arg.output
Make argument value outputing stream.&lt;br&gt;
It&#8217;s add useful validation and shortcut for STDOUT.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Arg</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Opt.comp
Set custom additional completion for current argument.&lt;br&gt;
<strong>&#64;param</strong> <em>Function</em> <cite>fn</cite> completion generation function,</p>
<blockquote>
<div><p>invoked in the context of command instance.
Accepts parameters:&lt;br&gt;</p>
<blockquote>
<div><ul class="simple">
<li><em>Object</em> <cite>opts</cite> completion options&lt;br&gt;</li>
</ul>
</div></blockquote>
<p>It can return promise or any other value treated as result.&lt;br&gt;</p>
</div></blockquote>
<p><strong>&#64;returns</strong> <em>COA.Arg</em> <cite>this</cite> instance (for chainability)</p>
<p>#### Arg.end
Finish chain for current option and return parent command instance.&lt;br&gt;
<strong>&#64;returns</strong> <em>COA.Cmd</em> <cite>parent</cite> command</p>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright © NFLabs. All rights reserved..

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../../../../../../../../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../../../../../../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../../../../../../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../../../../../../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../../../../../../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>